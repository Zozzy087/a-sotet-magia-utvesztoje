<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <title>Bás vagy Bas</title>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Cinzel', serif;
      background-image: url('images/background.jpg.jpg');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      color: #ffffff;
      margin: 0;
      padding: 20px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 {
      font-weight: 700;
      font-size: 2.5rem;
      background-color: rgba(0, 0, 0, 0.8);
      padding: 10px 20px;
      border-radius: 5px;
      margin-bottom: 20px;
      box-shadow: 0 0 15px rgba(127, 0, 255, 0.7);
      text-align: center;
    }
    #turnInfo, #result, #score {
      background-color: rgba(0, 0, 0, 0.7);
      padding: 8px 15px;
      border-radius: 5px;
      margin: 10px auto;
      box-shadow: 0 0 10px rgba(127, 0, 255, 0.4);
      text-align: center;
    }
    button {
      background-color: #7f00ff;
      color: white;
      border: none;
      border-radius: 5px;
      padding: 10px 20px;
      font-size: 1.1rem;
      cursor: pointer;
      box-shadow: 0 0 10px #7f00ff;
      transition: transform 0.2s, box-shadow 0.3s;
    }
    button:hover {
      transform: scale(1.1);
      box-shadow: 0 0 15px #a94bff;
    }
    
    /* Dobókocka stílus */
    .dice-container {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 20px 0;
    }
    .dice {
      width: 80px;
      height: 80px;
      background-color: rgba(0, 0, 0, 0.8);
      border: 2px solid #7f00ff;
      border-radius: 10px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 2.5rem;
      box-shadow: 0 0 10px rgba(127, 0, 255, 0.4);
    }
    .hidden-dice {
      color: transparent;
      text-shadow: 0 0 8px rgba(255, 255, 255, 0.5);
    }
    
    /* Dobás bemondás */
    #announcementSection {
      display: none;
      flex-direction: column;
      align-items: center;
      margin: 20px 0;
    }
    #diceValueSection {
      display: none;
      background-color: rgba(0, 0, 0, 0.7);
      padding: 15px;
      border-radius: 5px;
      margin: 15px auto;
      text-align: center;
    }
    #valueOptions {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin: 15px 0;
      max-width: 600px;
    }
    .value-btn {
      background-color: rgba(0, 0, 0, 0.8);
      border: 2px solid #7f00ff;
      color: white;
      border-radius: 5px;
      padding: 8px 12px;
      font-size: 1rem;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.3s;
    }
    .value-btn:hover:not(:disabled) {
      transform: scale(1.1);
      box-shadow: 0 0 15px #a94bff;
    }
    .value-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    /* Bot válasz gombok */
    #botResponseSection {
      display: none;
      flex-direction: column;
      align-items: center;
      margin: 20px 0;
    }
    #botResponseButtons {
      display: flex;
      gap: 20px;
      margin: 15px 0;
    }
    
    /* Életek megjelenítése */
    #livesSection {
      display: flex;
      justify-content: space-around;
      width: 100%;
      max-width: 600px;
      margin: 15px 0;
    }
    .player-lives {
      background-color: rgba(0, 0, 0, 0.7);
      padding: 10px 15px;
      border-radius: 5px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .lives-container {
      display: flex;
      gap: 5px;
      margin-top: 5px;
    }
    .life {
      color: #ff5555;
      font-size: 1.5rem;
    }
    
    /* Játéktábla */
    #gameBoard {
      background-color: rgba(0, 0, 0, 0.7);
      border-radius: 10px;
      padding: 20px;
      margin: 15px 0;
      width: 100%;
      max-width: 600px;
      text-align: center;
    }
    
    /* Reszponzív stílusok */
    @media (max-width: 600px) {
      h1 {
        font-size: 1.8rem;
        padding: 8px 15px;
      }
      .dice {
        width: 60px;
        height: 60px;
        font-size: 2rem;
      }
      #valueOptions {
        gap: 5px;
      }
      .value-btn {
        padding: 6px 8px;
        font-size: 0.9rem;
      }
    }
    
    /* Eredmény panel */
    #resultPanel {
      display: none;
      background-color: rgba(0, 0, 0, 0.8);
      border: 2px solid #7f00ff;
      border-radius: 10px;
      padding: 20px;
      margin: 20px 0;
      text-align: center;
      width: 100%;
      max-width: 500px;
      box-shadow: 0 0 15px rgba(127, 0, 255, 0.5);
    }
    .win-text {
      color: #7fff7f;
      font-weight: bold;
      text-shadow: 1px 1px 4px black;
    }
    .lose-text {
      color: #ff7f7f;
      font-weight: bold;
      text-shadow: 1px 1px 4px black;
    }
    
    #resetContainer {
      margin-top: 20px;
      display: none;
    }
  </style>
  <!-- Font Awesome ikonokhoz -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>

<h1>Bás vagy Bas</h1>

<p id="turnInfo">Dobókockás blöffjáték</p>

<div id="livesSection">
  <div class="player-lives">
    <h3>Játékos</h3>
    <div class="lives-container" id="playerLives"></div>
  </div>
  <div class="player-lives">
    <h3>Számítógép</h3>
    <div class="lives-container" id="botLives"></div>
  </div>
</div>

<div id="gameBoard">
  <p id="gameStatus">Nyomd meg a "Dobás" gombot a kezdéshez!</p>
  
  <div class="dice-container" id="diceContainer">
    <div class="dice hidden-dice" id="dice1">?</div>
    <div class="dice hidden-dice" id="dice2">?</div>
  </div>
  
  <div id="diceValueSection">
    <h3>A dobásod értéke: <span id="realDiceValue"></span></h3>
    <p>Ezt csak te látod! A bot nem tudja, mit dobtál.</p>
  </div>
  
  <button id="rollButton" onclick="rollDice()">Dobás</button>
</div>

<div id="announcementSection">
  <h3>Válaszd ki a bemondott értéket:</h3>
  <p>Az előző érték: <span id="previousValue">-</span></p>
  <div id="valueOptions"></div>
</div>

<div id="botResponseSection">
  <h3>A bot eldönti, elhiszi-e:</h3>
  <p id="botThinking">A bot gondolkodik...</p>
  <div id="botResponseButtons">
    <button id="continueButton" onclick="continueTurn()">Tovább</button>
  </div>
</div>

<div id="resultPanel">
  <h3 id="resultTitle">Eredmény</h3>
  <p id="resultDescription"></p>
</div>

<div id="resetContainer">
  <button onclick="startGame()">Új játék</button>
</div>

<script>
// Játék állapota
let playerLives = 5;
let botLives = 5;
let currentPlayer = 'player'; // 'player' vagy 'bot'
let lastAnnouncedValue = null;
let playerDiceValue = null;
let botDiceValue = null;
let announcedValue = null;
let gameOver = false;

// Értékek sorrendje a játékban
const valueOrder = [
  "31", "32", "41", "42", "43", "51", "52", "53", "54", "61", "62", "63", "64", "65", 
  "bas1", "bas2", "bas3", "bas4", "bas5", "bas6", "21"
];

// Értékek magyar megnevezése
const valueNames = {
  "bas1": "1-es bás", "bas2": "2-es bás", "bas3": "3-as bás", 
  "bas4": "4-es bás", "bas5": "5-ös bás", "bas6": "6-os bás",
  "21": "huszonegy"
};

// Játék indítása
function startGame() {
  playerLives = 5;
  botLives = 5;
  currentPlayer = 'player';
  lastAnnouncedValue = null;
  playerDiceValue = null;
  botDiceValue = null;
  announcedValue = null;
  gameOver = false;
  
  updateLivesDisplay();
  
  // UI elemek visszaállítása
  document.getElementById('gameStatus').textContent = "Nyomd meg a \"Dobás\" gombot a kezdéshez!";
  document.getElementById('dice1').textContent = "?";
  document.getElementById('dice2').textContent = "?";
  document.getElementById('dice1').classList.add('hidden-dice');
  document.getElementById('dice2').classList.add('hidden-dice');
  
  document.getElementById('rollButton').style.display = 'block';
  document.getElementById('announcementSection').style.display = 'none';
  document.getElementById('botResponseSection').style.display = 'none';
  document.getElementById('diceValueSection').style.display = 'none';
  document.getElementById('resultPanel').style.display = 'none';
  document.getElementById('resetContainer').style.display = 'none';
  
  document.getElementById('turnInfo').textContent = "Dobókockás blöffjáték";
}

// Életek megjelenítésének frissítése
function updateLivesDisplay() {
  const playerLivesContainer = document.getElementById('playerLives');
  const botLivesContainer = document.getElementById('botLives');
  
  playerLivesContainer.innerHTML = '';
  botLivesContainer.innerHTML = '';
  
  for (let i = 0; i < playerLives; i++) {
    playerLivesContainer.innerHTML += '<span class="life"><i class="fas fa-heart"></i></span>';
  }
  
  for (let i = 0; i < botLives; i++) {
    botLivesContainer.innerHTML += '<span class="life"><i class="fas fa-heart"></i></span>';
  }
}

// Dobókocka dobás
function rollDice() {
  // Kockák értékeinek generálása
  const die1 = Math.floor(Math.random() * 6) + 1;
  const die2 = Math.floor(Math.random() * 6) + 1;
  
  // Kockák megjelenítése
  document.getElementById('dice1').textContent = die1;
  document.getElementById('dice2').textContent = die2;
  
  // Az aktuális játékostól függően mutatjuk vagy elrejtjük a kockákat
  if (currentPlayer === 'player') {
    document.getElementById('dice1').classList.remove('hidden-dice');
    document.getElementById('dice2').classList.remove('hidden-dice');
    
    // Játékos dobásának értéke
    playerDiceValue = calculateDiceValue(die1, die2);
    document.getElementById('realDiceValue').textContent = formatValue(playerDiceValue);
    document.getElementById('diceValueSection').style.display = 'block';
    
    // Értékválasztó megjelenítése
    showAnnouncementOptions();
  } else {
    // Bot dobása - elrejtve marad
    document.getElementById('dice1').classList.add('hidden-dice');
    document.getElementById('dice2').classList.add('hidden-dice');
    
    botDiceValue = calculateDiceValue(die1, die2);
    
    // Bot választ egy értéket
    setTimeout(() => {
      makeBotAnnouncement();
    }, 1500);
  }
  
  // Dobógomb elrejtése
  document.getElementById('rollButton').style.display = 'none';
}

// Dobókockák értékének kiszámítása a játékszabály szerint
function calculateDiceValue(die1, die2) {
  // Ha a két dobott érték 1 és 2 (bármilyen sorrendben), akkor "21" (huszonegy)
  if ((die1 === 1 && die2 === 2) || (die1 === 2 && die2 === 1)) {
    return "21";
  }
  
  // Ha a két dobott érték egyezik, akkor bás
  if (die1 === die2) {
    return "bas" + die1;
  }
  
  // Egyébként a nagyobb szám * 10 + kisebb szám
  const higherDie = Math.max(die1, die2);
  const lowerDie = Math.min(die1, die2);
  
  return higherDie + "" + lowerDie;
}

// Érték formázása megjelenítéshez
function formatValue(value) {
  if (value.startsWith("bas")) {
    const basNumber = value.substring(3);
    return valueNames["bas" + basNumber];
  }
  
  if (value === "21") {
    return valueNames["21"];
  }
  
  return value;
}

// Értékválasztó opciók megjelenítése
function showAnnouncementOptions() {
  document.getElementById('announcementSection').style.display = 'flex';
  
  const valueOptionsContainer = document.getElementById('valueOptions');
  valueOptionsContainer.innerHTML = '';
  
  const previousValue = document.getElementById('previousValue');
  previousValue.textContent = lastAnnouncedValue ? formatValue(lastAnnouncedValue) : "-";
  
  // Összes lehetséges érték megjelenítése
  let startFromIndex = 0;
  
  // Ha van előző érték, akkor csak a nagyobb vagy egyenlő értékeket mutatjuk
  if (lastAnnouncedValue) {
    startFromIndex = valueOrder.indexOf(lastAnnouncedValue);
    if (startFromIndex === -1) startFromIndex = 0;
  }
  
  for (let i = startFromIndex; i < valueOrder.length; i++) {
    const value = valueOrder[i];
    const button = document.createElement('button');
    button.className = 'value-btn';
    button.setAttribute('data-value', value);
    button.textContent = formatValue(value);
    button.addEventListener('click', () => announceValue(value));
    valueOptionsContainer.appendChild(button);
  }
}

// Érték bejelentése
function announceValue(value) {
  announcedValue = value;
  lastAnnouncedValue = value;
  
  document.getElementById('announcementSection').style.display = 'none';
  document.getElementById('gameStatus').textContent = `Te bejelentettél: ${formatValue(value)}`;
  
  // Bot válaszának kezdeményezése
  document.getElementById('botResponseSection').style.display = 'flex';
  document.getElementById('botThinking').style.display = 'block';
  document.getElementById('botResponseButtons').style.display = 'none';
  
  setTimeout(() => {
    botRespondsToAnnouncement();
  }, 2000);
}

// Bot válasza a bejelentésre
function botRespondsToAnnouncement() {
  document.getElementById('botThinking').style.display = 'none';
  document.getElementById('botResponseButtons').style.display = 'flex';
  
  // Bot eldönti, hogy elhiszi-e
  const believeThreshold = calculateBelieveThreshold();
  const botBelieves = Math.random() < believeThreshold;
  
  if (botBelieves) {
    // Bot elhiszi
    document.getElementById('gameStatus').textContent = "A bot elhiszi a bejelentésedet!";
    
    // Következő kör kezdődik
    setTimeout(() => {
      currentPlayer = 'bot';
      prepareNextTurn();
    }, 2000);
  } else {
    // Bot nem hiszi el
    document.getElementById('gameStatus').textContent = "A bot NEM hiszi el a bejelentésedet!";
    
    // Eredmény megjelenítése
    setTimeout(() => {
      showResult(false);
    }, 2000);
  }
}

// Bot intelligens döntéshozatala: elhiszi-e a játékos bejelentését
function calculateBelieveThreshold() {
  // Alap valószínűség
  let threshold = 0.7;
  
  // Minél nagyobb a bejelentett érték, annál kisebb a valószínűsége
  const valueIndex = valueOrder.indexOf(announcedValue);
  threshold -= (valueIndex / valueOrder.length) * 0.3;
  
  // Ha a játékos már korábban is blöffölt, csökkentjük a bizalmat
  if (announcedValue !== playerDiceValue) {
    // A játékos blöfföl
    const realValueIndex = valueOrder.indexOf(playerDiceValue);
    
    // Minél nagyobb a különbség, annál gyanúsabb
    const difference = valueIndex - realValueIndex;
    threshold -= difference * 0.05;
  }
  
  // Határok közé szorítjuk
  return Math.min(Math.max(threshold, 0.2), 0.9);
}

// Bot értékbejelentése
function makeBotAnnouncement() {
  // Bot intelligens döntéshozatala: mit jelentsen be
  let announceIndex;
  
  if (lastAnnouncedValue) {
    // Megkeressük az előző bejelentett érték indexét
    const lastIndex = valueOrder.indexOf(lastAnnouncedValue);
    
    // A bot dobásának indexe
    const botValueIndex = valueOrder.indexOf(botDiceValue);
    
    if (botValueIndex >= lastIndex) {
      // Bot igazat mondhat
      announceIndex = botValueIndex;
    } else {
      // Bot blöffölni kényszerül
      
      // Minél kisebb a különbség, annál kisebb eséllyel blöfföl nagyot
      const maxAddition = Math.floor(Math.random() * 3) + 1;
      announceIndex = lastIndex + Math.min(maxAddition, valueOrder.length - lastIndex - 1);
    }
  } else {
    // Nincs előző érték, szabadon választhat
    const botValueIndex = valueOrder.indexOf(botDiceValue);
    
    // Néha javít a valós értékén
    if (Math.random() < 0.3 && botValueIndex < valueOrder.length - 3) {
      announceIndex = botValueIndex + Math.floor(Math.random() * 3) + 1;
    } else {
      announceIndex = botValueIndex;
    }
  }
  
  // Bot bejelenti az értéket
  const botAnnouncedValue = valueOrder[announceIndex];
  lastAnnouncedValue = botAnnouncedValue;
  announcedValue = botAnnouncedValue;
  
  document.getElementById('gameStatus').textContent = `Bot bejelentett: ${formatValue(botAnnouncedValue)}`;
  
  // Játékos válaszolhat
  document.getElementById('botResponseSection').style.display = 'flex';
  document.getElementById('botThinking').style.display = 'none';
  document.getElementById('botResponseButtons').innerHTML = `
    <button onclick="playerResponds(true)">Elhiszem</button>
    <button onclick="playerResponds(false)">Nem hiszem el</button>
  `;
}

// Játékos válasza a bot bejelentésére
function playerResponds(believes) {
  document.getElementById('botResponseSection').style.display = 'none';
  
  if (believes) {
    // Játékos elhiszi
    document.getElementById('gameStatus').textContent = "Elhiszed a bot bejelentését!";
    
    // Következő kör kezdődik
    setTimeout(() => {
      currentPlayer = 'player';
      prepareNextTurn();
    }, 2000);
  } else {
    // Játékos nem hiszi el
    document.getElementById('gameStatus').textContent = "NEM hiszed el a bot bejelentését!";
    
    // Eredmény megjelenítése
    setTimeout(() => {
      showResult(true);
    }, 2000);
  }
}

// Következő kör előkészítése
function prepareNextTurn() {
  // Dobógomb megjelenítése
  document.getElementById('rollButton').style.display = 'block';
  
  // Kockák elrejtése
  document.getElementById('dice1').textContent = "?";
  document.getElementById('dice2').textContent = "?";
  document.getElementById('dice1').classList.add('hidden-dice');
  document.getElementById('dice2').classList.add('hidden-dice');
  
  // Játékállapot frissítése
  if (currentPlayer === 'player') {
    document.getElementById('gameStatus').textContent = "Te következel. Nyomd meg a \"Dobás\" gombot!";
    document.getElementById('turnInfo').textContent = "Te következel";
  } else {
    document.getElementById('gameStatus').textContent = "A bot következik...";
    document.getElementById('turnInfo').textContent = "Bot következik";
    
    // Bot automatikusan dob
    setTimeout(() => {
      rollDice();
    }, 1500);
  }
  
  // Egyéb UI elemek elrejtése
  document.getElementById('diceValueSection').style.display = 'none';
  document.getElementById('announcementSection').style.display = 'none';
  document.getElementById('botResponseSection').style.display = 'none';
  document.getElementById('resultPanel').style.display = 'none';
}

// Eredmény megjelenítése
function showResult(playerChallenged) {
  // Kártyák megmutatása
  if (playerChallenged) {
    // Bot dobása láthatóvá válik
    document.getElementById('dice1').classList.remove('hidden-dice');
    document.getElementById('dice2').classList.remove('hidden-dice');
  }
  
  document.getElementById('resultPanel').style.display = 'block';
  
  let resultTitle = "Eredmény";
  let resultDescription = "";
  
  if (playerChallenged) {
    // Játékos kérdőjelezte meg a bot bejelentését
    const botActualIndex = valueOrder.indexOf(botDiceValue);
    const botAnnouncedIndex = valueOrder.indexOf(announcedValue);
    
    if (botActualIndex >= botAnnouncedIndex) {
      // Bot igazat mondott
      resultTitle = "Vesztettél egy életet!";
      resultDescription = `
        A bot igazat mondott! A bot valóban ${formatValue(botDiceValue)}-t dobott.
        Te vesztesz egy életet.
      `;
      playerLives--;
    } else {
      // Bot blöffölt
      resultTitle = "A bot veszít egy életet!";
      resultDescription = `
        Elkapod a blöffölés közben! A bot valójában ${formatValue(botDiceValue)}-t dobott,
        de ${formatValue(announcedValue)}-t mondott be. A bot veszít egy életet.
      `;
      botLives--;
    }
  } else {
    // Bot kérdőjelezte meg a játékos bejelentését
    const playerActualIndex = valueOrder.indexOf(playerDiceValue);
    const playerAnnouncedIndex = valueOrder.indexOf(announcedValue);
    
    if (playerActualIndex >= playerAnnouncedIndex) {
      // Játékos igazat mondott
      resultTitle = "A bot veszít egy életet!";
      resultDescription = `
        Igazat mondtál! Valóban ${formatValue(playerDiceValue)}-t dobtál.
        A bot veszít egy életet.
      `;
      botLives--;
    } else {
      // Játékos blöffölt
      resultTitle = "Vesztettél egy életet!";
      resultDescription = `
        Elkaptak blöffölés közben! Valójában ${formatValue(playerDiceValue)}-t dobtál,
        de ${formatValue(announcedValue)}-t mondtál be. Vesztesz egy életet.
      `;
      playerLives--;
    }
  }
  
  document.getElementById('resultTitle').textContent = resultTitle;
  document.getElementById('resultDescription').innerHTML = resultDescription;
  
  // Életek frissítése
  updateLivesDisplay();
  
  // Ellenőrizzük, vége van-e a játéknak
  if (playerLives <= 0 || botLives <= 0) {
    endGame();
  } else {
    // Folytatás gomb megjelenítése
    document.getElementById('botResponseButtons').innerHTML = `
      <button id="continueButton" onclick="continueTurn()">Tovább</button>
    `;
    document.getElementById('botResponseSection').style.display = 'flex';
    document.getElementById('botThinking').style.display = 'none';
    document.getElementById('botResponseButtons').style.display = 'flex';
  }
}

// Kör folytatása
function continueTurn() {
  lastAnnouncedValue = null;
  document.getElementById('botResponseSection').style.display = 'none';
  
  // A kezdő játékos váltakozik
  currentPlayer = (currentPlayer === 'player') ? 'bot' : 'player';
  
  prepareNextTurn();
}

// Játék vége
function endGame() {
  gameOver = true;
  
  let finalMessage = "";
  if (playerLives <= 0) {
    finalMessage = `<p class="lose-text">Vesztettél! Elfogytak az életeid.</p>`;
  } else {
    finalMessage = `<p class="win-text">Gratulálunk! Nyertél! A bot kifogyott az életekből.</p>`;
  }
  
  document.getElementById('resultDescription').innerHTML += finalMessage;
  document.getElementById('resetContainer').style.display = 'block';
  document.getElementById('botResponseSection').style.display = 'none';
}

// Kezdjük a játékot
startGame();
</script>
</body>
</html>
