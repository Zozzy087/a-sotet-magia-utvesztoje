<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <title>Haj√≥, Kapit√°ny, Leg√©nys√©g</title>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Cinzel', serif;
      background-image: url('images/background.jpg.jpg');
      background-size: cover;
      background-position: center;
      color: white;
      margin: 0;
      padding: 20px;
      text-align: center;
    }
    h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
      background-color: rgba(0, 0, 0, 0.7);
      padding: 10px;
      border-radius: 10px;
      display: inline-block;
    }
    #playerArea, #botArea, #result, #status, #scoreBoard {
      margin-top: 20px;
      font-size: 1.2rem;
      background-color: rgba(0,0,0,0.6);
      padding: 10px;
      border-radius: 8px;
      display: inline-block;
      min-width: 300px;
    }
    .dice {
      font-size: 2.5rem;
      margin: 5px;
      display: inline-block;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .dice.kept {
      color: #7fff7f;
      transform: translateY(-10px);
    }
    .dice.disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
    #controls {
      margin-top: 20px;
    }
    button {
      background-color: #7f00ff;
      color: white;
      border: none;
      border-radius: 5px;
      padding: 10px 20px;
      font-size: 1.1rem;
      cursor: pointer;
      box-shadow: 0 0 10px #7f00ff;
      transition: transform 0.2s, box-shadow 0.3s;
      margin: 10px;
    }
    button:hover {
      transform: scale(1.1);
      box-shadow: 0 0 15px #a94bff;
    }
    #resetContainer {
      display: none;
      margin-top: 20px;
    }
    #rollsLeft {
      font-weight: bold;
      color: #ffcc00;
    }
    .ship-icon, .captain-icon, .crew-icon {
      display: inline-block;
      margin: 0 5px;
    }
    .ship-icon {
      color: #3498db;
    }
    .captain-icon {
      color: #e74c3c;
    }
    .crew-icon {
      color: #2ecc71;
    }
    .cargo {
      color: #f1c40f;
    }
    .player-title {
      margin-bottom: 10px;
      font-size: 1.3rem;
      text-decoration: underline;
    }
    #diceContainer {
      min-height: 80px;
    }
    #scoreBoard {
      display: flex;
      justify-content: space-around;
      max-width: 500px;
      margin-left: auto;
      margin-right: auto;
    }
    .score-column {
      text-align: center;
    }
    #turnStatus {
      margin-bottom: 10px;
      font-weight: bold;
    }
  </style>
</head>
<body>

<h1>Haj√≥, Kapit√°ny, Leg√©nys√©g</h1>

<div id="scoreBoard">
  <div class="score-column">
    <h3>J√°t√©kos</h3>
    <div id="playerScore">0</div>
  </div>
  <div class="score-column">
    <h3>Bot</h3>
    <div id="botScore">0</div>
  </div>
</div>

<div id="status">
  <div id="turnStatus">Most a j√°t√©kos k√∂vetkezik!</div>
  <div>H√°tral√©v≈ë dob√°sok: <span id="rollsLeft">3</span></div>
</div>

<div id="playerArea">
  <div class="player-title">J√°t√©kos kock√°i</div>
  <div>
    <span class="ship-icon">üö¢ Haj√≥ (6):</span> <span id="playerShip">‚ùå</span>
    <span class="captain-icon">üë®‚Äç‚úàÔ∏è Kapit√°ny (5):</span> <span id="playerCaptain">‚ùå</span>
    <span class="crew-icon">üë∑ Leg√©nys√©g (4):</span> <span id="playerCrew">‚ùå</span>
  </div>
  <div id="diceContainer"></div>
</div>

<div id="controls">
  <button id="rollButton" onclick="rollDice()">Dob√°s</button>
  <button id="endTurnButton" onclick="endTurn()" disabled>K√∂r befejez√©se</button>
</div>

<div id="botArea">
  <div class="player-title">Bot kock√°i</div>
  <div>
    <span class="ship-icon">üö¢ Haj√≥ (6):</span> <span id="botShip">‚ùå</span>
    <span class="captain-icon">üë®‚Äç‚úàÔ∏è Kapit√°ny (5):</span> <span id="botCaptain">‚ùå</span>
    <span class="crew-icon">üë∑ Leg√©nys√©g (4):</span> <span id="botCrew">‚ùå</span>
  </div>
  <div id="botDiceContainer"></div>
</div>

<div id="result"></div>

<div id="resetContainer">
  <button onclick="startGame()">√öj j√°t√©k</button>
</div>

<script>
// J√°t√©k √°llapot
let playerScore = 0;
let botScore = 0;
let currentPlayer = 'player'; // 'player' vagy 'bot'
let rollsLeft = 3;
let gameOver = false;

// Kock√°k √°llapota
let playerDice = [];
let playerKept = {
  ship: false,   // 6-os
  captain: false, // 5-√∂s
  crew: false,    // 4-es
  cargo: []       // A t√∂bbi kocka
};

let botDice = [];
let botKept = {
  ship: false,
  captain: false,
  crew: false,
  cargo: []
};

// J√°t√©k ind√≠t√°sa
function startGame() {
  playerScore = 0;
  botScore = 0;
  gameOver = false;
  document.getElementById("playerScore").textContent = playerScore;
  document.getElementById("botScore").textContent = botScore;
  document.getElementById("resetContainer").style.display = "none";
  document.getElementById("result").textContent = "";
  
  startPlayerTurn();
}

// A j√°t√©kos k√∂r√©nek ind√≠t√°sa
function startPlayerTurn() {
  currentPlayer = 'player';
  rollsLeft = 3;
  
  // Kock√°k alaphelyzetbe √°ll√≠t√°sa
  playerDice = [];
  playerKept = { ship: false, captain: false, crew: false, cargo: [] };
  
  // UI elemek friss√≠t√©se
  document.getElementById("rollsLeft").textContent = rollsLeft;
  document.getElementById("diceContainer").innerHTML = "";
  document.getElementById("playerShip").textContent = "‚ùå";
  document.getElementById("playerCaptain").textContent = "‚ùå";
  document.getElementById("playerCrew").textContent = "‚ùå";
  document.getElementById("turnStatus").textContent = "Most a j√°t√©kos k√∂vetkezik!";
  
  document.getElementById("rollButton").disabled = false;
  document.getElementById("endTurnButton").disabled = true;
}

// A bot k√∂r√©nek ind√≠t√°sa
function startBotTurn() {
  currentPlayer = 'bot';
  rollsLeft = 3;
  
  // Kock√°k alaphelyzetbe √°ll√≠t√°sa
  botDice = [];
  botKept = { ship: false, captain: false, crew: false, cargo: [] };
  
  // UI elemek friss√≠t√©se
  document.getElementById("rollsLeft").textContent = rollsLeft;
  document.getElementById("botDiceContainer").innerHTML = "";
  document.getElementById("botShip").textContent = "‚ùå";
  document.getElementById("botCaptain").textContent = "‚ùå";
  document.getElementById("botCrew").textContent = "‚ùå";
  document.getElementById("turnStatus").textContent = "Most a bot k√∂vetkezik!";
  
  document.getElementById("rollButton").disabled = true;
  document.getElementById("endTurnButton").disabled = true;
  
  // Bot automatikusan dob
  setTimeout(botRoll, 1000);
}

// Dob√°s kock√°kkal (j√°t√©kos)
function rollDice() {
  if (rollsLeft <= 0 || gameOver) return;
  
  rollsLeft--;
  document.getElementById("rollsLeft").textContent = rollsLeft;
  
  // √öj dob√°s a nem megtartott kock√°kkal
  let keptCount = 0;
  if (playerKept.ship) keptCount++;
  if (playerKept.captain) keptCount++;
  if (playerKept.crew) keptCount++;
  keptCount += playerKept.cargo.length;
  
  const diceToRoll = 5 - keptCount;
  playerDice = [];
  
  for (let i = 0; i < diceToRoll; i++) {
    playerDice.push(Math.floor(Math.random() * 6) + 1);
  }
  
  displayPlayerDice();
  checkForSCC('player');
  
  // Ha nincs t√∂bb dob√°s, vagy megvan minden sz√ºks√©ges kocka
  if (rollsLeft <= 0 || (playerKept.ship && playerKept.captain && playerKept.crew)) {
    document.getElementById("rollButton").disabled = true;
    document.getElementById("endTurnButton").disabled = false;
  }
}

// Bot dob√°sa
function botRoll() {
  if (rollsLeft <= 0 || gameOver) return;
  
  rollsLeft--;
  document.getElementById("rollsLeft").textContent = rollsLeft;
  
  // √öj dob√°s a nem megtartott kock√°kkal
  let keptCount = 0;
  if (botKept.ship) keptCount++;
  if (botKept.captain) keptCount++;
  if (botKept.crew) keptCount++;
  keptCount += botKept.cargo.length;
  
  const diceToRoll = 5 - keptCount;
  botDice = [];
  
  for (let i = 0; i < diceToRoll; i++) {
    botDice.push(Math.floor(Math.random() * 6) + 1);
  }
  
  displayBotDice();
  checkForSCC('bot');
  
  // K√∂vetkez≈ë l√©p√©s automatikusan
  if (rollsLeft > 0 && !(botKept.ship && botKept.captain && botKept.crew)) {
    setTimeout(botRoll, 1500);
  } else {
    setTimeout(endTurn, 1500);
  }
}

// Kock√°k megjelen√≠t√©se (j√°t√©kos)
function displayPlayerDice() {
  const container = document.getElementById("diceContainer");
  container.innerHTML = "";
  
  // Megtartott kock√°k
  if (playerKept.ship) {
    container.innerHTML += `<span class="dice kept ship-icon">üé≤6</span>`;
  }
  if (playerKept.captain) {
    container.innerHTML += `<span class="dice kept captain-icon">üé≤5</span>`;
  }
  if (playerKept.crew) {
    container.innerHTML += `<span class="dice kept crew-icon">üé≤4</span>`;
  }
  playerKept.cargo.forEach(value => {
    container.innerHTML += `<span class="dice kept cargo">üé≤${value}</span>`;
  });
  
  // Kidobott, m√©g nem megtartott kock√°k
  playerDice.forEach((value, index) => {
    const disabled = (value === 6 && !playerKept.ship) || 
                   (value === 5 && playerKept.ship && !playerKept.captain) || 
                   (value === 4 && playerKept.ship && playerKept.captain && !playerKept.crew);
    
    const className = `dice ${disabled ? '' : 'disabled'}`;
    container.innerHTML += `<span class="${className}" onclick="keepDice(${index})">${'üé≤'+value}</span>`;
  });
}

// Kock√°k megjelen√≠t√©se (bot)
function displayBotDice() {
  const container = document.getElementById("botDiceContainer");
  container.innerHTML = "";
  
  // Megtartott kock√°k
  if (botKept.ship) {
    container.innerHTML += `<span class="dice kept ship-icon">üé≤6</span>`;
  }
  if (botKept.captain) {
    container.innerHTML += `<span class="dice kept captain-icon">üé≤5</span>`;
  }
  if (botKept.crew) {
    container.innerHTML += `<span class="dice kept crew-icon">üé≤4</span>`;
  }
  botKept.cargo.forEach(value => {
    container.innerHTML += `<span class="dice kept cargo">üé≤${value}</span>`;
  });
  
  // Kidobott kock√°k
  botDice.forEach(value => {
    container.innerHTML += `<span class="dice">üé≤${value}</span>`;
  });
}

// Kocka megtart√°sa (j√°t√©kos)
function keepDice(index) {
  if (rollsLeft <= 0 || gameOver) return;
  
  const value = playerDice[index];
  
  // 6-ost mindig meg lehet tartani (haj√≥)
  if (value === 6 && !playerKept.ship) {
    playerKept.ship = true;
    document.getElementById("playerShip").textContent = "‚úÖ";
    playerDice.splice(index, 1);
  }
  // 5-√∂st csak akkor, ha m√°r van haj√≥
  else if (value === 5 && playerKept.ship && !playerKept.captain) {
    playerKept.captain = true;
    document.getElementById("playerCaptain").textContent = "‚úÖ";
    playerDice.splice(index, 1);
  }
  // 4-est csak akkor, ha m√°r van haj√≥ √©s kapit√°ny
  else if (value === 4 && playerKept.ship && playerKept.captain && !playerKept.crew) {
    playerKept.crew = true;
    document.getElementById("playerCrew").textContent = "‚úÖ";
    playerDice.splice(index, 1);
  }
  // Ha m√°r megvan a haj√≥, kapit√°ny √©s leg√©nys√©g, a t√∂bbi kocka a rakom√°ny
  else if (playerKept.ship && playerKept.captain && playerKept.crew) {
    playerKept.cargo.push(value);
    playerDice.splice(index, 1);
  }
  
  displayPlayerDice();
  
  // Ha megvan minden sz√ºks√©ges kocka
  if (playerKept.ship && playerKept.captain && playerKept.crew && playerKept.cargo.length + playerDice.length === 2) {
    document.getElementById("rollButton").disabled = true;
    document.getElementById("endTurnButton").disabled = false;
  }
}

// Ellen≈ërzi, hogy megvan-e a Ship, Captain, Crew (automatikusan megtartja)
function checkForSCC(player) {
  const dice = player === 'player' ? playerDice : botDice;
  const kept = player === 'player' ? playerKept : botKept;
  
  // Ship (6) keres√©se
  if (!kept.ship) {
    const shipIndex = dice.findIndex(d => d === 6);
    if (shipIndex !== -1) {
      kept.ship = true;
      dice.splice(shipIndex, 1);
      document.getElementById(player + "Ship").textContent = "‚úÖ";
    }
  }
  
  // Captain (5) keres√©se (csak ha m√°r van haj√≥)
  if (kept.ship && !kept.captain) {
    const captainIndex = dice.findIndex(d => d === 5);
    if (captainIndex !== -1) {
      kept.captain = true;
      dice.splice(captainIndex, 1);
      document.getElementById(player + "Captain").textContent = "‚úÖ";
    }
  }
  
  // Crew (4) keres√©se (csak ha m√°r van haj√≥ √©s kapit√°ny)
  if (kept.ship && kept.captain && !kept.crew) {
    const crewIndex = dice.findIndex(d => d === 4);
    if (crewIndex !== -1) {
      kept.crew = true;
      dice.splice(crewIndex, 1);
      document.getElementById(player + "Crew").textContent = "‚úÖ";
    }
  }
  
  // Ha megvan a ship, captain, crew, automatikusan megtartjuk a rakom√°nyt is
  if (kept.ship && kept.captain && kept.crew) {
    kept.cargo = [...kept.cargo, ...dice];
    dice.length = 0;
  }
  
  // UI friss√≠t√©se
  if (player === 'player') {
    displayPlayerDice();
  } else {
    displayBotDice();
  }
}

// K√∂r befejez√©se
function endTurn() {
  if (gameOver) return;
  
  let points = 0;
  let resultText = "";
  
  if (currentPlayer === 'player') {
    // J√°t√©kos k√∂re v√©get √©r
    if (playerKept.ship && playerKept.captain && playerKept.crew) {
      // Sikeresen √∂sszegy≈±jt√∂tte az SCC-t
      points = playerKept.cargo.reduce((sum, val) => sum + val, 0);
      playerScore += points;
      resultText = `A j√°t√©kos sikeresen √∂sszegy≈±jt√∂tte a haj√≥t, kapit√°nyt √©s leg√©nys√©get! Rakom√°ny √©rt√©ke: ${points} pont.`;
    } else {
      resultText = "A j√°t√©kos nem tudta √∂sszegy≈±jteni a haj√≥t, kapit√°nyt √©s leg√©nys√©get. 0 pont.";
    }
    
    document.getElementById("playerScore").textContent = playerScore;
    document.getElementById("result").textContent = resultText;
    
    // Bot k√∂re k√∂vetkezik
    setTimeout(startBotTurn, 2000);
  } else {
    // Bot k√∂re v√©get √©r
    if (botKept.ship && botKept.captain && botKept.crew) {
      // Bot sikeresen √∂sszegy≈±jt√∂tte az SCC-t
      points = botKept.cargo.reduce((sum, val) => sum + val, 0);
      botScore += points;
      resultText = `A bot sikeresen √∂sszegy≈±jt√∂tte a haj√≥t, kapit√°nyt √©s leg√©nys√©get! Rakom√°ny √©rt√©ke: ${points} pont.`;
    } else {
      resultText = "A bot nem tudta √∂sszegy≈±jteni a haj√≥t, kapit√°nyt √©s leg√©nys√©get. 0 pont.";
    }
    
    document.getElementById("botScore").textContent = botScore;
    document.getElementById("result").textContent = resultText;
    
    // Ellen≈ërizz√ºk, v√©ge-e a j√°t√©knak
    if (playerScore >= 100 || botScore >= 100) {
      gameOver = true;
      const winner = playerScore >= 100 ? "J√°t√©kos" : "Bot";
      document.getElementById("result").innerHTML += `<br><strong>${winner} nyerte a j√°t√©kot!</strong>`;
      document.getElementById("resetContainer").style.display = "block";
    } else {
      // J√°t√©kos k√∂re k√∂vetkezik
      setTimeout(startPlayerTurn, 2000);
    }
  }
}

// J√°t√©k ind√≠t√°sa
startGame();
</script>

</body>
</html>
