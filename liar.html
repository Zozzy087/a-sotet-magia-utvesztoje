<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <title>Bás - Hazudós Kockajáték</title>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Cinzel', serif;
      background-image: url('images/background.jpg.jpg');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      color: #ffffff;
      margin: 0;
      padding: 20px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 {
      font-weight: 700;
      font-size: 2.5rem;
      background-color: rgba(0, 0, 0, 0.8);
      padding: 10px 20px;
      border-radius: 5px;
      margin-bottom: 20px;
      box-shadow: 0 0 15px rgba(127, 0, 255, 0.7);
      text-align: center;
    }
    #gameInfo, #turnInfo, #result, #score {
      background-color: rgba(0, 0, 0, 0.7);
      padding: 8px 15px;
      border-radius: 5px;
      margin: 10px auto;
      box-shadow: 0 0 10px rgba(127, 0, 255, 0.4);
      text-align: center;
    }
    button {
      background-color: #7f00ff;
      color: white;
      border: none;
      border-radius: 5px;
      padding: 10px 20px;
      font-size: 1.1rem;
      cursor: pointer;
      box-shadow: 0 0 10px #7f00ff;
      transition: transform 0.2s, box-shadow 0.3s;
    }
    button:hover {
      transform: scale(1.1);
      box-shadow: 0 0 15px #a94bff;
    }
    .dice-container {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 20px 0;
    }
    .dice {
      width: 80px;
      height: 80px;
      background-color: rgba(0, 0, 0, 0.8);
      border: 2px solid #7f00ff;
      box-shadow: 0 0 10px rgba(127, 0, 255, 0.5);
      border-radius: 10px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 2.5rem;
      color: white;
    }
    .hidden-dice {
      position: relative;
      overflow: hidden;
    }
    .hidden-dice::after {
      content: '?';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 2.5rem;
    }
    #actions {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin: 20px 0;
      align-items: center;
    }
    .value-select {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin: 10px 0;
      max-width: 500px;
    }
    .value-btn {
      background-color: rgba(0, 0, 0, 0.8);
      border: 2px solid #7f00ff;
      color: white;
      border-radius: 5px;
      padding: 8px;
      min-width: 40px;
      font-size: 0.9rem;
      cursor: pointer;
      box-shadow: 0 0 10px rgba(127, 0, 255, 0.3);
      transition: transform 0.2s, box-shadow 0.3s;
    }
    .value-btn:hover, .value-btn.selected {
      transform: scale(1.1);
      box-shadow: 0 0 15px #a94bff;
      background-color: rgba(127, 0, 255, 0.3);
    }
    .value-btn.disabled {
      opacity: 0.5;
      pointer-events: none;
    }
    .lives {
      display: flex;
      gap: 5px;
      margin: 5px 0;
    }
    .life {
      color: #ff5555;
      font-size: 1.5rem;
    }
    .player-info {
      display: flex;
      justify-content: space-between;
      width: 100%;
      max-width: 600px;
      margin: 10px 0;
    }
    .player-box {
      background-color: rgba(0, 0, 0, 0.7);
      padding: 10px;
      border-radius: 5px;
      border: 2px solid #7f00ff;
      min-width: 200px;
    }
    .declaration {
      background-color: rgba(127, 0, 255, 0.2);
      padding: 10px;
      border-radius: 5px;
      margin: 10px 0;
      text-align: center;
      font-weight: bold;
      font-size: 1.2rem;
    }
    .red-text {
      color: #ff5555;
    }
    .green-text {
      color: #5f5;
    }
    #resetContainer {
      margin-top: 20px;
      display: none;
    }
    
    /* Reszponzív stílusok */
    @media (max-width: 600px) {
      h1 {
        font-size: 1.8rem;
        padding: 8px 15px;
      }
      .dice {
        width: 60px;
        height: 60px;
        font-size: 2rem;
      }
      .player-box {
        min-width: 140px;
      }
    }
  </style>
  <!-- Font Awesome ikonokhoz -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>

<h1>Bás - Hazudós Kockajáték</h1>

<div id="gameInfo">Dobj nagyobbat vagy hazudj ügyesen!</div>
<div id="turnInfo">A játék indul...</div>

<div class="player-info">
  <div class="player-box">
    <h3>Játékos</h3>
    <div class="lives" id="playerLives"></div>
  </div>
  <div class="player-box">
    <h3>Bot</h3>
    <div class="lives" id="botLives"></div>
  </div>
</div>

<div id="declaration" class="declaration"></div>

<div class="dice-container" id="diceContainer"></div>

<div id="actions">
  <button id="rollButton" onclick="playerRoll()">Dobás</button>
  
  <div id="declareContainer" style="display: none;">
    <div id="valueSelectContainer" class="value-select"></div>
    <button id="declareButton" onclick="playerDeclare()">Bemondás</button>
  </div>
  
  <div id="believeContainer" style="display: none;">
    <button id="believeButton" onclick="playerBelieve(true)">Elhiszem</button>
    <button id="doubtButton" onclick="playerBelieve(false)">Kétlem</button>
  </div>
</div>

<h2 id="result"></h2>

<div id="resetContainer">
  <button onclick="startGame()">Új játék</button>
</div>

<script>
// Értékek rangsorolása
const VALUES = [
  '31', '32', '41', '42', '43', '51', '52', '53', '54',
  '61', '62', '63', '64', '65', 'B1', 'B2', 'B3', 'B4', 'B5', 'B6', '21'
];

// Játék állapotok
let playerLives = 5;
let botLives = 5;
let currentPlayer = 'player'; // 'player' vagy 'bot'
let lastDeclaredValue = null;
let currentDice = [1, 1];
let gameInProgress = true;

// Segédfüggvények
function getValueIndex(value) {
  return VALUES.indexOf(value);
}

// Két dobás értékének kiszámítása
function calculateValue(dice) {
  // Kettes és Egyes speciális eset (21)
  if ((dice[0] === 2 && dice[1] === 1) || (dice[0] === 1 && dice[1] === 2)) {
    return '21';
  }
  
  // Két egyforma szám (Bás)
  if (dice[0] === dice[1]) {
    return 'B' + dice[0];
  }
  
  // Hagyományos értékek (nagyobb szám elöl)
  let higher = Math.max(dice[0], dice[1]);
  let lower = Math.min(dice[0], dice[1]);
  return '' + higher + lower;
}

// Értékek magyar neve
function getValueName(value) {
  if (value === '21') {
    return 'Huszonegy';
  }
  if (value.startsWith('B')) {
    return value[1] + '-es Bás';
  }
  return value;
}

// Játék indítása
function startGame() {
  playerLives = 5;
  botLives = 5;
  currentPlayer = 'player';
  lastDeclaredValue = null;
  currentDice = [1, 1];
  gameInProgress = true;
  
  updateLives();
  document.getElementById('turnInfo').textContent = 'Te kezdesz! Kattints a Dobás gombra.';
  document.getElementById('result').textContent = '';
  document.getElementById('declaration').textContent = '';
  document.getElementById('diceContainer').innerHTML = '';
  
  // Gombok állapotának beállítása
  document.getElementById('rollButton').style.display = 'block';
  document.getElementById('declareContainer').style.display = 'none';
  document.getElementById('believeContainer').style.display = 'none';
  document.getElementById('resetContainer').style.display = 'none';
}

// Életek frissítése
function updateLives() {
  const playerLivesContainer = document.getElementById('playerLives');
  const botLivesContainer = document.getElementById('botLives');
  
  playerLivesContainer.innerHTML = '';
  botLivesContainer.innerHTML = '';
  
  for (let i = 0; i < playerLives; i++) {
    playerLivesContainer.innerHTML += '<span class="life"><i class="fas fa-heart"></i></span>';
  }
  
  for (let i = 0; i < botLives; i++) {
    botLivesContainer.innerHTML += '<span class="life"><i class="fas fa-heart"></i></span>';
  }
}

// Játékos dobása
function playerRoll() {
  if (!gameInProgress || currentPlayer !== 'player') return;
  
  // Dobás kockákkal
  currentDice = [
    Math.floor(Math.random() * 6) + 1,
    Math.floor(Math.random() * 6) + 1
  ];
  
  // Dobás megjelenítése
  document.getElementById('diceContainer').innerHTML = `
    <div class="dice">${currentDice[0]}</div>
    <div class="dice">${currentDice[1]}</div>
  `;
  
  document.getElementById('turnInfo').textContent = 'Mit mondasz, mit dobtál?';
  document.getElementById('rollButton').style.display = 'none';
  
  // Érték választó megjelenítése
  createValueSelector();
  document.getElementById('declareContainer').style.display = 'block';
}

// Érték választó létrehozása
function createValueSelector() {
  const container = document.getElementById('valueSelectContainer');
  container.innerHTML = '';
  
  let minValueIndex = 0;
  if (lastDeclaredValue) {
    minValueIndex = getValueIndex(lastDeclaredValue);
  }
  
  for (let i = 0; i < VALUES.length; i++) {
    const button = document.createElement('button');
    button.textContent = getValueName(VALUES[i]);
    button.className = 'value-btn';
    button.setAttribute('data-value', VALUES[i]);
    
    // Ha a gomb értéke kisebb, mint az előző bemondás, akkor tiltás
    if (i < minValueIndex) {
      button.classList.add('disabled');
    } else {
      button.onclick = function() {
        // Jelölés kiválasztottként
        document.querySelectorAll('.value-btn').forEach(btn => {
          btn.classList.remove('selected');
        });
        this.classList.add('selected');
      };
    }
    
    container.appendChild(button);
  }
}

// Játékos bemond egy értéket
function playerDeclare() {
  const selectedButton = document.querySelector('.value-btn.selected');
  if (!selectedButton) {
    alert('Válassz egy értéket!');
    return;
  }
  
  const declaredValue = selectedButton.getAttribute('data-value');
  lastDeclaredValue = declaredValue;
  
  document.getElementById('declaration').textContent = `Te bemondtad: ${getValueName(declaredValue)}`;
  
  document.getElementById('declareContainer').style.display = 'none';
  document.getElementById('turnInfo').textContent = 'A bot gondolkodik...';
  
  // Kockák elrejtése
  document.getElementById('diceContainer').innerHTML = '';
  
  // Bot döntés késleltetéssel
  setTimeout(() => {
    botDecideToDoubt(declaredValue);
  }, 1500);
}

// Bot eldönti, elhiszi-e a bemondást
function botDecideToDoubt(declaredValue) {
  // Aktuális dobás értékének kiszámítása
  const actualValue = calculateValue(currentDice);
  const declaredValueIndex = getValueIndex(declaredValue);
  const actualValueIndex = getValueIndex(actualValue);
  
  // A bot döntési logikája
  let doubt = false;
  
  // Minél nagyobb a különbség a bemondott és a lehetséges maximum között, annál gyanúsabb
  const maxValueIndex = VALUES.length - 1;
  const suspicionFactor = (declaredValueIndex / maxValueIndex);
  
  // Kis dobás esetén a bot valószínűbben kételkedik a nagy bemondásban
  if (actualValueIndex < 5 && declaredValueIndex > 10) {
    doubt = Math.random() < 0.7;
  } 
  // Huszonegy vagy nagy Bás bemondásánál erős kételkedés
  else if (declaredValue === '21' || declaredValue.startsWith('B') && parseInt(declaredValue[1]) > 3) {
    doubt = Math.random() < 0.6;
  } 
  // Magasabb értékeknél növekvő valószínűséggel kételkedik
  else {
    doubt = Math.random() < suspicionFactor * 0.5;
  }
  
  // Bot döntés megjelenítése
  if (doubt) {
    document.getElementById('turnInfo').textContent = 'A bot kétli a bemondásodat!';
    
    // Eredmény ellenőrzése
    setTimeout(() => {
      checkResult(declaredValue, actualValue, 'bot');
    }, 1000);
  } else {
    document.getElementById('turnInfo').textContent = 'A bot elhitte! Most ő következik.';
    
    // Bot köre következik
    setTimeout(() => {
      currentPlayer = 'bot';
      botTurn();
    }, 1500);
  }
}

// Bot köre
function botTurn() {
  // Bot dob
  currentDice = [
    Math.floor(Math.random() * 6) + 1,
    Math.floor(Math.random() * 6) + 1
  ];
  
  const actualValue = calculateValue(currentDice);
  
  // Rejtett dobás megjelenítése
  document.getElementById('diceContainer').innerHTML = `
    <div class="dice hidden-dice">?</div>
    <div class="dice hidden-dice">?</div>
  `;
  
  document.getElementById('turnInfo').textContent = 'A bot dobott, de te nem láthatod.';
  
  // Bot bemondás logikája
  let declaredValue;
  
  // Ha a valós dobás értéke nagyobb vagy egyenlő, mint az előző bemondás, a botnak nem kell hazudnia
  const actualValueIndex = getValueIndex(actualValue);
  const lastDeclaredValueIndex = lastDeclaredValue ? getValueIndex(lastDeclaredValue) : -1;
  
  if (actualValueIndex >= lastDeclaredValueIndex) {
    // Az esetek többségében az igazat mondja
    if (Math.random() < 0.7) {
      declaredValue = actualValue;
    } else {
      // Esetenként blöfföl, nagyobbat mond
      const possibleValues = VALUES.slice(actualValueIndex + 1);
      if (possibleValues.length > 0) {
        // Csak kicsit nagyobb értéket blöfföl
        const maxBluffIndex = Math.min(3, possibleValues.length - 1);
        const bluffIndex = Math.floor(Math.random() * (maxBluffIndex + 1));
        declaredValue = possibleValues[bluffIndex];
      } else {
        declaredValue = actualValue;
      }
    }
  } else {
    // Ha a bot dobása kisebb, mint az előző bemondás, hazudnia kell
    const possibleValues = VALUES.slice(lastDeclaredValueIndex);
    // Próbál csak kicsit nagyobbat mondani
    const maxBluffIndex = Math.min(2, possibleValues.length - 1);
    const bluffIndex = Math.floor(Math.random() * (maxBluffIndex + 1));
    declaredValue = possibleValues[bluffIndex];
  }
  
  lastDeclaredValue = declaredValue;
  
  // Bot bemondás megjelenítése
  setTimeout(() => {
    document.getElementById('declaration').textContent = `Bot bemondta: ${getValueName(declaredValue)}`;
    document.getElementById('turnInfo').textContent = 'Elhiszed vagy kétled?';
    document.getElementById('believeContainer').style.display = 'block';
  }, 1500);
}

// Játékos eldönti, elhiszi-e a bot bemondását
function playerBelieve(believe) {
  document.getElementById('believeContainer').style.display = 'none';
  
  if (believe) {
    document.getElementById('turnInfo').textContent = 'Elhitted a bot bemondását. Te következel!';
    
    // Játékos köre következik
    setTimeout(() => {
      currentPlayer = 'player';
      document.getElementById('rollButton').style.display = 'block';
      document.getElementById('diceContainer').innerHTML = '';
      document.getElementById('declaration').textContent = '';
      document.getElementById('turnInfo').textContent = 'Kattints a Dobás gombra!';
    }, 1500);
  } else {
    document.getElementById('turnInfo').textContent = 'Kétled a bot bemondását!';
    
    // Eredmény ellenőrzése
    const actualValue = calculateValue(currentDice);
    
    // Kockák felfedése
    document.getElementById('diceContainer').innerHTML = `
      <div class="dice">${currentDice[0]}</div>
      <div class="dice">${currentDice[1]}</div>
    `;
    
    setTimeout(() => {
      checkResult(lastDeclaredValue, actualValue, 'player');
    }, 1000);
  }
}

// Ellenőrzi az eredményt és frissíti a pontszámot
function checkResult(declaredValue, actualValue, doubter) {
  const declaredValueIndex = getValueIndex(declaredValue);
  const actualValueIndex = getValueIndex(actualValue);
  
  // Eldönti, ki veszít életet
  let loser;
  if (declaredValueIndex <= actualValueIndex) {
    // A kétkedő veszít, mert az érték jó volt vagy jobb
    loser = doubter;
    document.getElementById('result').innerHTML = `<span class="green-text">Bemondás igazolva!</span> A valós dobás: ${getValueName(actualValue)}`;
  } else {
    // A bemondó veszít, mert hazudott
    loser = doubter === 'player' ? 'bot' : 'player';
    document.getElementById('result').innerHTML = `<span class="red-text">Lebukott a hazugság!</span> A valós dobás: ${getValueName(actualValue)}`;
  }
  
  // Élet levonása
  if (loser === 'player') {
    playerLives--;
    document.getElementById('turnInfo').textContent = 'Vesztettél egy életet!';
  } else {
    botLives--;
    document.getElementById('turnInfo').textContent = 'A bot vesztett egy életet!';
  }
  
  updateLives();
  
  // Játék állapotának ellenőrzése
  setTimeout(() => {
    if (playerLives <= 0) {
      gameOver('bot');
    } else if (botLives <= 0) {
      gameOver('player');
    } else {
      // Új kör, a kétkedő kezd
      currentPlayer = doubter;
      lastDeclaredValue = null;
      
      if (currentPlayer === 'player') {
        document.getElementById('rollButton').style.display = 'block';
        document.getElementById('diceContainer').innerHTML = '';
        document.getElementById('declaration').textContent = '';
        document.getElementById('result').textContent = '';
        document.getElementById('turnInfo').textContent = 'Új kör! Te kezdesz. Kattints a Dobás gombra!';
      } else {
        document.getElementById('diceContainer').innerHTML = '';
        document.getElementById('declaration').textContent = '';
        document.getElementById('result').textContent = '';
        document.getElementById('turnInfo').textContent = 'Új kör! A bot kezd.';
        
        setTimeout(() => {
          botTurn();
        }, 1500);
      }
    }
  }, 2000);
}

// Játék vége
function gameOver(winner) {
  gameInProgress = false;
  
  if (winner === 'player') {
    document.getElementById('result').innerHTML = '<span class="winner">Gratulálunk, nyertél!</span>';
  } else {
    document.getElementById('result').innerHTML = '<span class="winner">A bot nyert, próbáld újra!</span>';
  }
  
  document.getElementById('rollButton').style.display = 'none';
  document.getElementById('declareContainer').style.display = 'none';
  document.getElementById('believeContainer').style.display = 'none';
  document.getElementById('resetContainer').style.display = 'block';
}

// Játék indítása
startGame();
</script>
</body>
</html>
