<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <title>Kockapóker Blöff</title>
  <link href="https://fonts.googleapis.com/css2?family=Eczar:wght@400..800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    body {
      font-family: "Eczar", serif;
      background-image: url('images/background.jpg.jpg');
      background-size: cover;
      background-position: center;
      color: #d1c3af;
      margin: 0;
      padding: 20px;
      text-align: center;
      background-color: #0c0c0c;
    }
    h1 {
      font-size: 2.6rem;
      margin-bottom: 10px;
      background-color: rgba(0, 0, 0, 0.7);
      padding: 15px;
      border-radius: 5px;
      display: inline-block;
      text-shadow: 0 0 10px #ff6400;
      letter-spacing: 2px;
    }
    .game-container {
      max-width: 800px;
      margin: 0 auto;
    }
    .sparks-container {
      display: flex;
      justify-content: space-between;
      margin: 20px 0;
    }
    .sparks {
      background-color: rgba(20, 14, 10, 0.85);
      padding: 10px 20px;
      border-radius: 5px;
      min-width: 200px;
      text-align: center;
    }
    .spark-icon {
      color: #ff6400;
      font-size: 1.5rem;
      margin: 0 3px;
      text-shadow: 0 0 10px rgba(255, 100, 0, 0.7);
    }
    .inactive {
      color: #482c17;
      text-shadow: none;
    }
    .dice-area {
      background-color: rgba(20, 14, 10, 0.85);
      padding: 20px;
      border-radius: 5px;
      margin: 20px 0;
      border: 1px solid #482c17;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
    }
    .dice-title {
      font-size: 1.4rem;
      margin-bottom: 15px;
      color: #d1c3af;
    }
    .dice {
      font-size: 2.5rem;
      margin: 5px;
      display: inline-block;
      transition: all 0.3s ease;
    }
    .dice-container {
      margin: 10px 0;
    }
    .controls {
      background-color: rgba(20, 14, 10, 0.85);
      padding: 20px;
      border-radius: 5px;
      margin: 20px 0;
    }
    .announcement {
      margin-bottom: 20px;
      font-size: 1.2rem;
    }
    select, button {
      font-family: 'Eczar', serif;
      font-size: 1rem;
      padding: 10px;
      margin: 5px;
      border-radius: 5px;
      border: none;
      cursor: pointer;
      background-color: #482c17;
      color: #d1c3af;
    }
    select {
      background-color: #291d14;
    }
    button {
      background-color: #7f00ff;
      color: white;
      box-shadow: 0 0 10px #7f00ff;
      transition: all 0.3s;
      letter-spacing: 1px;
    }
    button:hover {
      background-color: #a94bff;
      transform: scale(1.05);
      box-shadow: 0 0 15px #a94bff;
    }
    .ability-button {
      background-color: #ff6400;
      box-shadow: 0 0 10px #ff6400;
    }
    .ability-button:hover {
      background-color: #ff8a44;
      box-shadow: 0 0 15px #ff8a44;
    }
    .status {
      background-color: rgba(20, 14, 10, 0.85);
      padding: 15px;
      border-radius: 5px;
      margin: 20px 0;
      font-size: 1.2rem;
      line-height: 1.4;
    }
    .current-player {
      color: #ff6400;
      font-weight: bold;
    }
    .hidden {
      display: none;
    }
    .combination-info {
      background-color: rgba(20, 14, 10, 0.7);
      padding: 10px;
      border-radius: 5px;
      margin: 10px 0;
      font-size: 0.9rem;
      text-align: left;
    }
    .highlight {
      color: #ff6400;
      font-weight: bold;
    }
    .dice-roll {
      animation: rollDice 0.8s ease-out;
    }
    @keyframes rollDice {
      0% { transform: rotateY(0deg); }
      50% { transform: rotateY(180deg); }
      100% { transform: rotateY(360deg); }
    }
    #abilities {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-top: 15px;
    }
  </style>
</head>
<body>

<h1>Kockapóker Blöff</h1>

<div class="game-container">
  <div class="combination-info">
    <p><span class="highlight">Kombinációk és képességek:</span></p>
    <p>• <strong>Három egyforma:</strong> Meglesheted az ellenfél következő dobását</p>
    <p>• <strong>Három egyforma + két egyforma (Full House):</strong> Ha nem hiszik el, és igazad van, 2 isteni szikrát veszítenek</p>
    <p>• <strong>Négy egyforma:</strong> Védelmet kapsz egy isteni szikra elvesztése ellen</p>
    <p>• <strong>Öt egyforma:</strong> Visszaszerezhetsz egy elvesztett isteni szikrát</p>
  </div>

  <div class="sparks-container">
    <div class="sparks" id="playerSparks">
      <h3>Játékos Isteni Szikrái</h3>
      <div id="playerSparksIcons">
        <i class="fas fa-fire spark-icon"></i>
        <i class="fas fa-fire spark-icon"></i>
        <i class="fas fa-fire spark-icon"></i>
        <i class="fas fa-fire spark-icon"></i>
        <i class="fas fa-fire spark-icon"></i>
      </div>
    </div>
    <div class="sparks" id="botSparks">
      <h3>Gép Isteni Szikrái</h3>
      <div id="botSparksIcons">
        <i class="fas fa-fire spark-icon"></i>
        <i class="fas fa-fire spark-icon"></i>
        <i class="fas fa-fire spark-icon"></i>
        <i class="fas fa-fire spark-icon"></i>
        <i class="fas fa-fire spark-icon"></i>
      </div>
    </div>
  </div>

  <div class="dice-area" id="playerDiceArea">
    <h3 class="dice-title">Játékos Kockái</h3>
    <div class="dice-container" id="playerDice"></div>
  </div>

  <div class="dice-area hidden" id="botDiceArea">
    <h3 class="dice-title">Gép Kockái</h3>
    <div class="dice-container" id="botDice"></div>
  </div>

  <div class="controls" id="announceControls">
    <div class="announcement">
      <p>Mit jelentesz be? (választhatsz igazat vagy blöffölhetsz)</p>
      <select id="combinationSelect">
        <option value="none">-- Válassz kombinációt --</option>
        <option value="three">Három egyforma</option>
        <option value="fullhouse">Full House (három + két egyforma)</option>
        <option value="four">Négy egyforma</option>
        <option value="five">Öt egyforma</option>
      </select>
      <select id="valueSelect">
        <option value="1">1-esek</option>
        <option value="2">2-esek</option>
        <option value="3">3-asok</option>
        <option value="4">4-esek</option>
        <option value="5">5-ösök</option>
        <option value="6">6-osok</option>
      </select>
      <button id="announceBtn" onclick="announcePlayerCombination()">Bejelentés</button>
    </div>
  </div>

  <div class="controls hidden" id="responseControls">
    <div class="announcement">
      <p>A gép bejelentése: <span id="botAnnouncement" class="highlight"></span></p>
      <button id="believeBtn" onclick="believeBotAnnouncement()">Elhiszem</button>
      <button id="challengeBtn" onclick="challengeBotAnnouncement()">Nem hiszem el!</button>
    </div>
  </div>

  <div class="controls hidden" id="botResponseControls">
    <div class="announcement">
      <p>A játékos bejelentése: <span id="playerAnnouncement" class="highlight"></span></p>
      <p>A gép döntése: <span id="botDecision" class="highlight"></span></p>
      <button id="continueBtn" onclick="continueAfterResponse()">Folytatás</button>
    </div>
  </div>

  <div id="abilities" class="hidden">
    <!-- Dinamikusan feltöltve a képességek alapján -->
  </div>

  <div class="status" id="gameStatus">
    <p>A játék kezdődik. Te következel!</p>
  </div>

  <div class="controls hidden" id="nextRoundControls">
    <button id="nextRoundBtn" onclick="startNextRound()">Következő kör</button>
  </div>

  <div class="controls hidden" id="newGameControls">
    <button id="newGameBtn" onclick="startNewGame()">Új játék</button>
  </div>
</div>

<script>
// Játék állapot
let gameState = {
  playerSparks: 5,
  botSparks: 5,
  playerDice: [],
  botDice: [],
  currentPlayer: 'player', // 'player' vagy 'bot'
  lastAnnouncement: null,
  activeAbility: null,
  lastLoser: null
};

// Kombinációk és értékeik
const combinations = {
  'three': { name: 'Három egyforma', rank: 1, ability: 'peekAtOpponent' },
  'fullhouse': { name: 'Full House', rank: 2, ability: 'doubleDamage' },
  'four': { name: 'Négy egyforma', rank: 3, ability: 'protection' },
  'five': { name: 'Öt egyforma', rank: 4, ability: 'restoreSpark' }
};

// Képességek leírása
const abilities = {
  'peekAtOpponent': { name: 'Ellenfél megtekintése', description: 'Meglesheted az ellenfél következő dobását' },
  'doubleDamage': { name: 'Kétszeres sebzés', description: 'Ha nem hiszik el a Full House-t, de igazad van, 2 szikrát veszít' },
  'protection': { name: 'Védelem', description: 'Megvéd egy isteni szikra elvesztésétől' },
  'restoreSpark': { name: 'Helyreállítás', description: 'Visszaszerzel egy elvesztett isteni szikrát' }
};

// Játék indítása
function startNewGame() {
  gameState = {
    playerSparks: 5,
    botSparks: 5,
    playerDice: [],
    botDice: [],
    currentPlayer: 'player',
    lastAnnouncement: null,
    activeAbility: null,
    lastLoser: null
  };
  
  updateSparksUI();
  startNewRound();
  
  document.getElementById('newGameControls').classList.add('hidden');
  document.getElementById('botDiceArea').classList.add('hidden');
  document.getElementById('abilities').classList.add('hidden');
  document.getElementById('gameStatus').innerHTML = '<p>A játék kezdődik. Te következel!</p>';
}

// Új kör indítása
function startNewRound() {
  // Előző kör takarítása
  document.getElementById('announceControls').classList.add('hidden');
  document.getElementById('responseControls').classList.add('hidden');
  document.getElementById('botResponseControls').classList.add('hidden');
  document.getElementById('nextRoundControls').classList.add('hidden');
  document.getElementById('abilities').classList.add('hidden');
  document.getElementById('botDiceArea').classList.add('hidden');
  
  // Meghatározzuk ki kezd (legutóbbi vesztes)
  if (gameState.lastLoser) {
    gameState.currentPlayer = gameState.lastLoser;
  } else {
    gameState.currentPlayer = 'player';
  }
  
  // Kockák dobása
  gameState.playerDice = rollDice(5);
  gameState.botDice = rollDice(5);
  
  // UI frissítése
  renderDice(gameState.playerDice, 'playerDice');
  document.getElementById('botDice').innerHTML = '';
  
  if (gameState.currentPlayer === 'player') {
    document.getElementById('announceControls').classList.remove('hidden');
    document.getElementById('gameStatus').innerHTML = '<p><span class="current-player">Te következel!</span> Válassz egy kombinációt, amit bejelentesz.</p>';
  } else {
    document.getElementById('gameStatus').innerHTML = '<p><span class="current-player">A gép következik...</span> Gondolkozik a bejelentésen.</p>';
    setTimeout(botAnnounce, 2000);
  }
  
  updateSparksUI();
  gameState.lastAnnouncement = null;
}

// Következő kör indítása
function startNextRound() {
  if (gameState.playerSparks <= 0 || gameState.botSparks <= 0) {
    endGame();
    return;
  }
  
  startNewRound();
}

// Játék vége
function endGame() {
  let winner = gameState.playerSparks > 0 ? 'player' : 'bot';
  let message = winner === 'player' ? 
    'Gratulálunk! Te nyerted a játékot!' : 
    'Sajnáljuk, a gép nyerte a játékot!';
  
  document.getElementById('gameStatus').innerHTML = `<p><span class="highlight">${message}</span></p>`;
  document.getElementById('newGameControls').classList.remove('hidden');
  document.getElementById('nextRoundControls').classList.add('hidden');
}

// 5 kocka dobása
function rollDice(count) {
  const dice = [];
  for (let i = 0; i < count; i++) {
    dice.push(Math.floor(Math.random() * 6) + 1);
  }
  return dice;
}

// Kockák megjelenítése
function renderDice(dice, containerId) {
  const container = document.getElementById(containerId);
  container.innerHTML = '';
  
  // Rendezzük a kockákat a jobb láthatóság érdekében
  const sortedDice = [...dice].sort((a, b) => a - b);
  
  sortedDice.forEach(value => {
    const diceEl = document.createElement('span');
    diceEl.className = 'dice dice-roll';
    diceEl.innerHTML = getDiceHTML(value);
    container.appendChild(diceEl);
  });
}

// Kocka HTML (emojik helyett Font Awesome ikonok)
function getDiceHTML(value) {
  return `<i class="fas fa-dice-${getDiceIcon(value)}"></i>`;
}

// Kocka ikon neve
function getDiceIcon(value) {
  const icons = ['one', 'two', 'three', 'four', 'five', 'six'];
  return icons[value - 1];
}

// Szikrák UI frissítése
function updateSparksUI() {
  updateSparkIcons('playerSparksIcons', gameState.playerSparks);
  updateSparkIcons('botSparksIcons', gameState.botSparks);
}

// Szikra ikonok frissítése
function updateSparkIcons(containerId, count) {
  const container = document.getElementById(containerId);
  const icons = container.querySelectorAll('.spark-icon');
  
  icons.forEach((icon, index) => {
    if (index < count) {
      icon.classList.remove('inactive');
    } else {
      icon.classList.add('inactive');
    }
  });
}

// Játékos kombináció bejelentése
function announcePlayerCombination() {
  const combinationType = document.getElementById('combinationSelect').value;
  const valueType = document.getElementById('valueSelect').value;
  
  if (combinationType === 'none') {
    alert('Válassz egy kombinációt!');
    return;
  }
  
  const combination = combinations[combinationType];
  gameState.lastAnnouncement = {
    type: combinationType,
    value: parseInt(valueType),
    player: 'player'
  };
  
  document.getElementById('playerAnnouncement').textContent = 
    `${combination.name} ${valueType}-es értékkel`;
  
  document.getElementById('announceControls').classList.add('hidden');
  document.getElementById('botResponseControls').classList.remove('hidden');
  
  document.getElementById('gameStatus').innerHTML = 
    `<p>Bejelentetted: <span class="highlight">${combination.name} ${valueType}-es értékkel</span>. A gép dönt, hogy elhiszi-e...</p>`;
  
  // Bot döntése
  setTimeout(() => {
    const botBelieves = botDecideToChallenge();
    document.getElementById('botDecision').textContent = botBelieves ? 'Elhiszem' : 'Nem hiszem el!';
    
    if (botBelieves) {
      document.getElementById('gameStatus').innerHTML += 
        `<p>A gép elhiszi a bejelentésedet. Most ő következik!</p>`;
      
      // Ellenőrizzük, volt-e valódi kombináció
      const playerHasAnnouncement = checkCombination(gameState.playerDice, gameState.lastAnnouncement);
      
      // Ha valódi a kombináció, aktiváljuk a képességet
      if (playerHasAnnouncement) {
        offerAbility(gameState.lastAnnouncement.type);
      }
      
      gameState.currentPlayer = 'bot';
      setTimeout(() => {
        document.getElementById('botResponseControls').classList.add('hidden');
        if (!gameState.activeAbility) {
          setTimeout(botAnnounce, 1000);
        }
      }, 2000);
    } else {
      // Bot nem hiszi el, ellenőrizzük
      document.getElementById('gameStatus').innerHTML += 
        `<p>A gép nem hiszi el a bejelentésedet. Felfedi a kockákat!</p>`;
      document.getElementById('botDiceArea').classList.remove('hidden');
      renderDice(gameState.botDice, 'botDice');
      
      // Ellenőrizzük a bejelentett kombinációt
      const playerHasAnnouncement = checkCombination(gameState.playerDice, gameState.lastAnnouncement);
      
      setTimeout(() => {
        if (playerHasAnnouncement) {
          // Játékos igazat mondott, bot veszít egy szikrát
          document.getElementById('gameStatus').innerHTML += 
            `<p>Igazat mondtál! A gép veszít egy isteni szikrát.</p>`;
          gameState.botSparks--;
          gameState.lastLoser = 'bot';
          
          // Double damage képesség ellenőrzése Full House esetén
          if (gameState.lastAnnouncement.type === 'fullhouse') {
            document.getElementById('gameStatus').innerHTML += 
              `<p class="highlight">Full House képesség aktiválva! A gép két szikrát veszít egy helyett!</p>`;
            gameState.botSparks--;
          }
          
          updateSparksUI();
          
          // Ha volt valódi kombináció, aktiváljuk a képességet
          if (playerHasAnnouncement) {
            offerAbility(gameState.lastAnnouncement.type);
          }
        } else {
          // Játékos hazudott, veszít egy szikrát
          document.getElementById('gameStatus').innerHTML += 
            `<p>Blöfföltél! Elvesztesz egy isteni szikrát.</p>`;
          
          // Védelem képesség ellenőrzése
          if (gameState.activeAbility === 'protection') {
            document.getElementById('gameStatus').innerHTML += 
              `<p class="highlight">Védelem képesség aktiválva! Nem veszítesz isteni szikrát!</p>`;
            gameState.activeAbility = null;
          } else {
            gameState.playerSparks--;
          }
          
          gameState.lastLoser = 'player';
          updateSparksUI();
        }
        
        // Következő lépések
        if (gameState.playerSparks <= 0 || gameState.botSparks <= 0) {
          setTimeout(endGame, 2000);
        } else {
          document.getElementById('nextRoundControls').classList.remove('hidden');
        }
        
        document.getElementById('botResponseControls').classList.add('hidden');
      }, 2000);
    }
  }, 2000);
}

// Bot kombináció bejelentése
function botAnnounce() {
  // Bot stratégia: Elég gyakran blöfföl
  // Ha van jó lapja, általában elmondja
  
  // Bot kockák elemzése, milyen kombinációi vannak
  const botCombinations = analyzeCombinations(gameState.botDice);
  let announcement;
  
  // Bot döntése
  const bluffChance = 0.4; // 40% esély a blöffre
  const willBluff = Math.random() < bluffChance;
  
  if (willBluff || botCombinations.length === 0) {
    // Blöff - véletlenszerű kombináció
    const combinationTypes = Object.keys(combinations);
    const randomType = combinationTypes[Math.floor(Math.random() * combinationTypes.length)];
    const randomValue = Math.floor(Math.random() * 6) + 1;
    
    announcement = {
      type: randomType,
      value: randomValue,
      player: 'bot',
      isBluff: true
    };
  } else {
    // Legjobb valós kombináció
    const bestCombination = botCombinations[0]; // A legmagasabb értékű
    
    announcement = {
      type: bestCombination.type,
      value: bestCombination.value,
      player: 'bot',
      isBluff: false
    };
  }
  
  gameState.lastAnnouncement = announcement;
  document.getElementById('botAnnouncement').textContent = 
    `${combinations[announcement.type].name} ${announcement.value}-ös értékkel`;
  
  document.getElementById('responseControls').classList.remove('hidden');
  document.getElementById('gameStatus').innerHTML = 
    `<p>A gép bejelentette: <span class="highlight">${combinations[announcement.type].name} ${announcement.value}-ös értékkel</span>. Elhiszed?</p>`;
}

// Kombinációk elemzése
function analyzeCombinations(dice) {
  const counts = {};
  dice.forEach(value => {
    counts[value] = (counts[value] || 0) + 1;
  });
  
  const results = [];
  
  // Öt egyforma
  for (let value in counts) {
    if (counts[value] === 5) {
      results.push({ type: 'five', value: parseInt(value), rank: combinations['five'].rank });
    }
  }
  
  // Négy egyforma
  for (let value in counts) {
    if (counts[value] === 4) {
      results.push({ type: 'four', value: parseInt(value), rank: combinations['four'].rank });
    }
  }
  
  // Full House
  let hasThree = false;
  let threeValue = 0;
  let hasTwo = false;
  
  for (let value in counts) {
    if (counts[value] === 3) {
      hasThree = true;
      threeValue = parseInt(value);
    } else if (counts[value] === 2) {
      hasTwo = true;
    }
  }
  
  if (hasThree && hasTwo) {
    results.push({ type: 'fullhouse', value: threeValue, rank: combinations['fullhouse'].rank });
  }
  
  // Három egyforma
  for (let value in counts) {
    if (counts[value] === 3 && !hasTwo) { // Csak ha nem volt Full House
      results.push({ type: 'three', value: parseInt(value), rank: combinations['three'].rank });
    }
  }
  
  // Rendezzük kombinációk erőssége alapján
  results.sort((a, b) => b.rank - a.rank);
  
  return results;
}

// Kombináció ellenőrzése
function checkCombination(dice, announcement) {
  if (!announcement) return false;
  
  const combinations = analyzeCombinations(dice);
  
  for (let combo of combinations) {
    if (combo.type === announcement.type && combo.value === announcement.value) {
      return true;
    }
  }
  
  return false;
}

// Bot döntése a kihívásról
function botDecideToChallenge() {
  // Bot stratégia a kihívásra
  // Megnézi a saját kockáit, és a bejelentett kombináció típusát
  const botCombinations = analyzeCombinations(gameState.botDice);
  const announcement = gameState.lastAnnouncement;
  
  if (!announcement) return true;
  
  // Alapértelmezett kihívási esély
  let challengeChance = 0.5; // 50% esély
  
  // Erős kombinációk esetén nagyobb eséllyel kihív
  if (announcement.type === 'five' || announcement.type === 'four') {
    challengeChance = 0.7; // 70% esély
  }
  
  // Ha a bot kockái között van olyan érték, ami a bejelentett értékkel egyezik
  // kevésbé valószínű, hogy kihív
  let hasMatchingValue = false;
  gameState.botDice.forEach(value => {
    if (value === announcement.value) {
      hasMatchingValue = true;
    }
  });
  
  if (hasMatchingValue) {
    challengeChance -= 0.2; // 20%-kal csökken a kihívás esélye
  }
  
  return Math.random() >= challengeChance; // true = elhiszi, false = kihívja
}

// Játékos elhiszi a bot bejelentését
function believeBotAnnouncement() {
  document.getElementById('responseControls').classList.add('hidden');
  
  document.getElementById('gameStatus').innerHTML = 
    `<p>Elhiszed a gép bejelentését. Most te következel!</p>`;
  
  // Ellenőrizzük, volt-e valódi kombináció
  const botHasAnnouncement = checkCombination(gameState.botDice, gameState.lastAnnouncement);
  
  // Bot képesség aktiválása ha valós kombináció volt
  if (botHasAnnouncement && !gameState.lastAnnouncement.isBluff) {
    activateBotAbility(gameState.lastAnnouncement.type);
  }
  
  gameState.currentPlayer = 'player';
  document.getElementById('announceControls').classList.remove('hidden');
}

// Játékos nem hiszi el a bot bejelentését
function challengeBotAnnouncement() {
  document.getElementById('responseControls').classList.add('hidden');
  document.getElementById('botDiceArea').classList.remove('hidden');
  renderDice(gameState.botDice, 'botDice');
  
  document.getElementById('gameStatus').innerHTML = 
    `<p>Nem hiszed el a gép bejelentését. A kockák felfedve!</p>`;
  
  // Ellenőrizzük a bejelentett kombinációt
  const botHasAnnouncement = checkCombination(gameState.botDice, gameState.lastAnnouncement);
  
  setTimeout(() => {
    if (botHasAnnouncement) {
      // Bot igazat mondott, játékos veszít egy szikrát
      document.getElementById('gameStatus').innerHTML += 
        `<p>A gép igazat mondott! Elvesztesz egy isteni szikrát.</p>`;
      
      // Védelem képesség ellenőrzése
      if (gameState.activeAbility === 'protection') {
        document.getElementById('gameStatus').innerHTML += 
          `<p class="highlight">Védelem képesség aktiválva! Nem veszítesz isteni szikrát!</p>`;
        gameState.activeAbility = null;
      } else {
        gameState.playerSparks--;
      }
      
      gameState.lastLoser = 'player';
      
      // Bot képesség aktiválása
      if (!gameState.lastAnnouncement.isBluff) {
        activateBotAbility(gameState.lastAnnouncement.type);
      }
    } else {
      // Bot hazudott, veszít egy szikrát
      document.getElementById('gameStatus').innerHTML += 
        `<p>A gép blöffölt! Elveszít egy isteni szikrát.</p>`;
      gameState.botSparks--;
      gameState.lastLoser = 'bot';
    }
    
    updateSparksUI();
    
    // Következő lépések
    if (gameState.playerSparks <= 0 || gameState.botSparks <= 0) {
      setTimeout(endGame, 2000);
    } else {
      document.getElementById('nextRoundControls').classList.remove('hidden');
    }
  }, 2000);
}

// Bot képesség aktiválása
function activateBotAbility(combinationType) {
  const ability = combinations[combinationType].ability;
  
  // Bot Full House double damage speciális eset
  if (combinationType === 'fullhouse' && gameState.lastLoser === 'player') {
    document.getElementById('gameStatus').innerHTML += 
      `<p class="highlight">A gép Full House képessége aktiválva! Még egy szikrát veszítesz!</p>`;
    gameState.playerSparks--;
    updateSparksUI();
    return;
  }
  
  // Bot képesség végrehajtása
  switch (ability) {
    case 'restoreSpark':
      if (gameState.botSparks < 5) {
        document.getElementById('gameStatus').innerHTML += 
          `<p class="highlight">A gép visszaszerez egy isteni szikrát!</p>`;
        gameState.botSparks++;
        updateSparksUI();
      }
      break;
    case 'protection':
      document.getElementById('gameStatus').innerHTML += 
        `<p class="highlight">A gép védettséget kap a következő isteni szikra vesztés ellen!</p>`;
      // Ez a bot következő köre előtt fog aktiválódni
      break;
    // Egyéb képességek megvalósítása
  }
}

// Képesség felajánlása a játékosnak
function offerAbility(combinationType) {
  const ability = combinations[combinationType].ability;
  gameState.activeAbility = ability;
  
  const abilitiesContainer = document.getElementById('abilities');
  abilitiesContainer.innerHTML = '';
  abilitiesContainer.classList.remove('hidden');
  
  const button = document.createElement('button');
  button.className = 'ability-button';
  button.textContent = `${abilities[ability].name} - ${abilities[ability].description}`;
  button.onclick = () => useAbility(ability);
  
  abilitiesContainer.appendChild(button);
  
  document.getElementById('gameStatus').innerHTML += 
    `<p class="highlight">Képesség aktiválva: ${abilities[ability].name}! Kattints a gombra a használatához.</p>`;
}

// Képesség használata
function useAbility(ability) {
  document.getElementById('abilities').classList.add('hidden');
  
  switch (ability) {
    case 'peekAtOpponent':
      // Ellenfél kockáinak megtekintése
      document.getElementById('botDiceArea').classList.remove('hidden');
      renderDice(gameState.botDice, 'botDice');
      document.getElementById('gameStatus').innerHTML += 
        `<p class="highlight">Megtekintheted a gép kockáit!</p>`;
      break;
    
    case 'doubleDamage':
      // Full House double damage - későbbi körben lesz hatása
      document.getElementById('gameStatus').innerHTML += 
        `<p class="highlight">Full House képesség aktiválva! Ha nem hiszik el a következő Full House bejelentésedet, két szikrát veszít az ellenfél!</p>`;
      break;
    
    case 'protection':
      // Védelem a következő isteni szikra vesztés ellen
      document.getElementById('gameStatus').innerHTML += 
        `<p class="highlight">Védelem képesség aktiválva! A következő isteni szikra vesztés ellen védettséget kapsz.</p>`;
      break;
    
    case 'restoreSpark':
      // Elveszett szikra visszaszerzése
      if (gameState.playerSparks < 5) {
        gameState.playerSparks++;
        updateSparksUI();
        document.getElementById('gameStatus').innerHTML += 
          `<p class="highlight">Visszaszereztél egy isteni szikrát!</p>`;
      } else {
        document.getElementById('gameStatus').innerHTML += 
          `<p class="highlight">Már maximális az isteni szikrák száma, a képesség hatástalan.</p>`;
      }
      break;
  }
  
  // Ha a bot a soron következő és nincs aktív képesség, a bot lép
  if (gameState.currentPlayer === 'bot') {
    gameState.activeAbility = null;
    setTimeout(botAnnounce, 2000);
  }
}

// Folytatás a válasz után
function continueAfterResponse() {
  document.getElementById('botResponseControls').classList.add('hidden');
  
  if (gameState.currentPlayer === 'bot') {
    setTimeout(botAnnounce, 1000);
  } else {
    document.getElementById('announceControls').classList.remove('hidden');
  }
}

// Játék indítása
startNewGame();
</script>

</body>
</html>
