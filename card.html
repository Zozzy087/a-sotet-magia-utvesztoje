<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <title>Kártyapárbaj</title>
  <style>
    body {
      font-family: sans-serif;
      background: #222;
      color: #eee;
      text-align: center;
      padding: 20px;
    }
    .card {
      background: #444;
      border: 1px solid #888;
      padding: 10px;
      margin: 10px;
      display: inline-block;
      width: 150px;
    }
    .winner {
      font-weight: bold;
      color: lightgreen;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      margin: 10px;
      cursor: pointer;
    }
    #cards {
      display: flex;
      justify-content: center;
      gap: 40px;
    }
  </style>
</head>
<body>

<h1>Kártyapárbaj</h1>

<p id="turnInfo">Várakozás a játék indítására...</p>

<div id="buttons">
  <button onclick="playerChooses('power')">Erő</button>
  <button onclick="playerChooses('agility')">Ügyesség</button>
  <button onclick="playerChooses('wisdom')">Bölcsesség</button>
</div>

<div id="cards"></div>
<h2 id="result"></h2>
<h3 id="score"></h3>

<script>
const allCards = [];
for (let i = 1; i <= 30; i++) {
  allCards.push({
    id: i,
    name: "Kártya " + i,
    power: Math.floor(Math.random() * 10) + 1,
    agility: Math.floor(Math.random() * 10) + 1,
    wisdom: Math.floor(Math.random() * 10) + 1
  });
}

let player1Deck = [];
let player2Deck = [];
let player1Wins = 0;
let player2Wins = 0;
let round = 0;

let lastWinner = null;
let consecutiveWins = { player1: 0, player2: 0 };
let currentTurn = "player1"; // elsőként Játékos 1 választhat

function drawHands() {
  const shuffled = [...allCards].sort(() => Math.random() - 0.5);
  player1Deck = shuffled.slice(0, 8);
  player2Deck = shuffled.slice(8, 16);
  player1Wins = 0;
  player2Wins = 0;
  round = 0;
  lastWinner = null;
  consecutiveWins = { player1: 0, player2: 0 };
  currentTurn = "player1";
  updateScore();
  updateTurnInfo();
  clearCardsAndResult();
}

function clearCardsAndResult() {
  document.getElementById("cards").innerHTML = "";
  document.getElementById("result").textContent = "";
}

function updateTurnInfo() {
  if (player1Wins >= 5 || player2Wins >= 5) {
    document.getElementById("turnInfo").textContent = "A játék véget ért!";
    return;
  }
  const name = currentTurn === "player1" ? "Játékos 1 választhat tulajdonságot" : "Bot választ...";
  document.getElementById("turnInfo").textContent = name;
}

function updateScore() {
  document.getElementById("score").textContent = `Állás: Játékos 1 - ${player1Wins} | Játékos 2 - ${player2Wins}`;
}

function playerChooses(attribute) {
  if (player1Wins >= 5 || player2Wins >= 5) return;
  if (currentTurn !== "player1") return;
  clearCardsAndResult();
  setTimeout(() => playRound(attribute), 200);
}

function playRound(attribute) {
  const card1 = player1Deck[round];
  const card2 = player2Deck[round];

  const value1 = card1[attribute];
  const value2 = card2[attribute];

  let resultText = "";

  if (value1 > value2) {
    player1Wins++;
    resultText = "Játékos 1 nyerte ezt a kört!";
    if (lastWinner === "player1") {
      consecutiveWins.player1++;
    } else {
      consecutiveWins.player1 = 1;
      consecutiveWins.player2 = 0;
    }
    lastWinner = "player1";
  } else if (value2 > value1) {
    player2Wins++;
    resultText = "Játékos 2 nyerte ezt a kört!";
    if (lastWinner === "player2") {
      consecutiveWins.player2++;
    } else {
      consecutiveWins.player2 = 1;
      consecutiveWins.player1 = 0;
    }
    lastWinner = "player2";
  } else {
    resultText = "Döntetlen!";
  }

  document.getElementById("cards").innerHTML = `
    <div class="card">
      <h3>Játékos 1</h3>
      <p>${card1.name}</p>
      <p>Erő: ${card1.power}</p>
      <p>Ügyesség: ${card1.agility}</p>
      <p>Bölcsesség: ${card1.wisdom}</p>
    </div>
    <div class="card">
      <h3>Játékos 2</h3>
      <p>${card2.name}</p>
      <p>Erő: ${card2.power}</p>
      <p>Ügyesség: ${card2.agility}</p>
      <p>Bölcsesség: ${card2.wisdom}</p>
    </div>
  `;

  round++;
  document.getElementById("result").textContent = resultText;
  updateScore();

  if (player1Wins >= 5) {
    document.getElementById("result").innerHTML += " <span class='winner'>Játékos 1 a győztes!</span>";
    return;
  }
  if (player2Wins >= 5) {
    document.getElementById("result").innerHTML += " <span class='winner'>Játékos 2 a győztes!</span>";
    return;
  }

  // Döntési jog váltása
  if (lastWinner === "player1" && consecutiveWins.player1 < 2) {
    currentTurn = "player1";
  } else if (lastWinner === "player2" && consecutiveWins.player2 < 2) {
    currentTurn = "player2";
  } else {
    currentTurn = lastWinner === "player1" ? "player2" : "player1";
  }

  updateTurnInfo();

    if (currentTurn === "player2") {
    setTimeout(() => {
      clearCardsAndResult();
      const attributes = ["power", "agility", "wisdom"];
      const attr = attributes[Math.floor(Math.random() * attributes.length)];
      playRound(attr);
    }, 800);
  }
}

drawHands();
</script>

</body>
</html>
