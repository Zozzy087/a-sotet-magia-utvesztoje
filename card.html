<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <title>K√°rtyap√°rbaj</title>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
  font-family: 'Cinzel', serif;
  background-image: url('images/background.jpg.jpg');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  color: #ffffff;
  margin: 0;
  padding: 20px;
  min-height: 100vh;
}

h1 {
  font-weight: 700;
  font-size: 2.5rem;
  background-color: rgba(0, 0, 0, 0.8);
  display: inline-block;
  padding: 10px 20px;
  border-radius: 5px;
  margin-bottom: 20px;
  box-shadow: 0 0 15px rgba(127, 0, 255, 0.7);
}

.hand {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 15px;
  margin-top: 20px;
}

.card {
  background-color: rgba(0, 0, 0, 0.8);
  border: 2px solid #7f00ff;
  padding: 12px;
  width: 100%;
  max-width: 200px;
  color: #fff;
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.3s;
  box-shadow: 0 0 10px rgba(127, 0, 255, 0.3);
  border-radius: 8px;
  text-align: left;
}

.card:hover {
  transform: scale(1.05);
  box-shadow: 0 0 20px rgba(127, 0, 255, 0.6);
}

.disabled {
  opacity: 0.5;
  pointer-events: none;
}

button {
  background-color: #7f00ff;
  color: white;
  border: none;
  border-radius: 5px;
  padding: 10px 20px;
  font-size: 1.1rem;
  margin: 10px 5px;
  cursor: pointer;
  box-shadow: 0 0 10px #7f00ff;
  transition: transform 0.2s, box-shadow 0.3s;
}

button:hover {
  transform: scale(1.1);
  box-shadow: 0 0 15px #a94bff;
}

.winner {
  color: #7fff7f;
  font-weight: bold;
  text-shadow: 1px 1px 4px black;
}

#battlefield {
  margin-top: 20px;
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 20px;
}

#turnInfo, #chosenAttr, #result, #score {
  background-color: rgba(0, 0, 0, 0.7);
  display: inline-block;
  padding: 8px 15px;
  border-radius: 5px;
  margin: 10px auto;
  box-shadow: 0 0 10px rgba(127, 0, 255, 0.4);
}

#resetContainer {
  margin-top: 20px;
  text-align: center;
  display: none;
}

/* üéØ Mobilbar√°t megjelen√≠t√©s */
@media (max-width: 768px) {
  h1 {
    font-size: 1.6rem;
    padding: 8px 15px;
  }

  .card {
    width: 90%;
    font-size: 0.95rem;
  }

  button {
    font-size: 1rem;
    padding: 8px 15px;
    width: 90%;
  }

  #turnInfo, #chosenAttr, #result, #score {
    font-size: 0.95rem;
    text-align: center;
    width: 90%;
  }

  #attributeButtons {
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  #battlefield {
    flex-direction: column;
    align-items: center;
  }
}

    #turnInfo, #chosenAttr, #result, #score {
      background-color: rgba(0, 0, 0, 0.7);
      display: inline-block;
      padding: 8px 15px;
      border-radius: 5px;
      margin: 10px auto;
      box-shadow: 0 0 10px rgba(127, 0, 255, 0.4);
    }

    #resetContainer {
      margin-top: 20px;
      text-align: center;
      display: none;
    }
  </style>
</head>
<body>

<h1>K√°rtyap√°rbaj</h1>

<p id="turnInfo">V√°rakoz√°s a j√°t√©k ind√≠t√°s√°ra...</p>

<div id="attributeButtons">
  <button onclick="chooseAttribute('power')">Er≈ë</button>
  <button onclick="chooseAttribute('agility')">√úgyess√©g</button>
  <button onclick="chooseAttribute('wisdom')">B√∂lcsess√©g</button>
</div>

<h2 id="chosenAttr"></h2>

<div class="hand" id="player1Hand"></div>

<div id="battlefield"></div>

<h2 id="result"></h2>
<h3 id="score"></h3>

<div id="resetContainer">
  <button onclick="startGame()">√öj j√°t√©k</button>
</div>

<script>
const allCards = [];
for (let i = 0; i < 100; i++) {
  allCards.push({
    power: Math.floor(Math.random() * 10) + 1,
    agility: Math.floor(Math.random() * 10) + 1,
    wisdom: Math.floor(Math.random() * 10) + 1
  });
}

let deckPool = [...allCards];
let player1Deck = [];
let player2Deck = [];
let player1Wins = 0;
let player2Wins = 0;
let lastWinner = "player1";
let selectedAttribute = null;
let roundInProgress = false;

function drawCard() {
  if (deckPool.length === 0) return null;
  return deckPool.splice(Math.floor(Math.random() * deckPool.length), 1)[0];
}

function refillHands() {
  while (player1Deck.length < 8) {
    const card = drawCard();
    if (card) player1Deck.push(card);
    else break;
  }
  while (player2Deck.length < 8) {
    const card = drawCard();
    if (card) player2Deck.push(card);
    else break;
  }
}

function startGame() {
  document.getElementById("resetContainer").style.display = "none";
  deckPool = [...allCards];
  player1Deck = [];
  player2Deck = [];
  player1Wins = 0;
  player2Wins = 0;
  lastWinner = "player1";
  selectedAttribute = null;
  roundInProgress = false;
  refillHands();
  updateUI();
}

function updateUI() {
  document.getElementById("result").textContent = "";
  document.getElementById("chosenAttr").textContent = selectedAttribute ? `Kiv√°lasztott tulajdons√°g: ${attributeHu(selectedAttribute)}` : "";
  document.getElementById("score").textContent = `√Åll√°s: J√°t√©kos 1 - ${player1Wins} | J√°t√©kos 2 - ${player2Wins}`;
  document.getElementById("turnInfo").textContent = lastWinner === "player1" ? "J√°t√©kos 1 v√°laszthat tulajdons√°got." : "Bot v√°laszt tulajdons√°got...";
  document.getElementById("player1Hand").innerHTML = "";
  document.getElementById("battlefield").innerHTML = "";

  renderPlayer1Hand();

  if (lastWinner === "player2" && !selectedAttribute && !roundInProgress) {
    setTimeout(() => {
      const attrs = ["power", "agility", "wisdom"];
      selectedAttribute = attrs[Math.floor(Math.random() * 3)];
      document.getElementById("chosenAttr").textContent = `Kiv√°lasztott tulajdons√°g: ${attributeHu(selectedAttribute)}`;
      updateUI();
    }, 1000);
  }

  const buttons = document.querySelectorAll("#attributeButtons button");
  buttons.forEach(btn => {
    btn.disabled = lastWinner !== "player1" || selectedAttribute !== null;
  });
}

function attributeHu(attr) {
  return attr === "power" ? "Er≈ë" : attr === "agility" ? "√úgyess√©g" : "B√∂lcsess√©g";
}

function chooseAttribute(attr) {
  if (lastWinner !== "player1" || selectedAttribute !== null) return;
  selectedAttribute = attr;
  document.getElementById("chosenAttr").textContent = `Kiv√°lasztott tulajdons√°g: ${attributeHu(selectedAttribute)}`;
  updateUI();
}

function renderPlayer1Hand() {
  player1Deck.forEach((card, index) => {
    const div = document.createElement("div");
    div.className = "card";
    div.innerHTML = `
      Er≈ë: ${card.power}<br>
      √úgyess√©g: ${card.agility}<br>
      B√∂lcsess√©g: ${card.wisdom}
    `;
    if (!selectedAttribute || roundInProgress) {
      div.classList.add("disabled");
    } else {
      div.onclick = () => playRound(index);
    }
    document.getElementById("player1Hand").appendChild(div);
  });
}

function playRound(player1Index, botIndex = null, botInitiated = false) {
  if (!selectedAttribute || roundInProgress) return;
  roundInProgress = true;

  const player1Card = botInitiated
    ? player1Deck.splice(Math.floor(Math.random() * player1Deck.length), 1)[0]
    : player1Deck.splice(player1Index, 1)[0];

  const finalBotIndex = botIndex !== null
    ? botIndex
    : getBestCardIndex(player2Deck, selectedAttribute, player1Card[selectedAttribute]);

  const player2Card = player2Deck.splice(finalBotIndex, 1)[0];

  const val1 = player1Card[selectedAttribute];
  const val2 = player2Card[selectedAttribute];

  const battleDiv = document.getElementById("battlefield");
  battleDiv.innerHTML = `
    <div class="card">
      <h3>J√°t√©kos 1</h3>
      <p>Er≈ë: ${player1Card.power}</p>
      <p>√úgyess√©g: ${player1Card.agility}</p>
      <p>B√∂lcsess√©g: ${player1Card.wisdom}</p>
    </div>
    <div class="card">
      <h3>J√°t√©kos 2</h3>
      <p>Er≈ë: ${player2Card.power}</p>
      <p>√úgyess√©g: ${player2Card.agility}</p>
      <p>B√∂lcsess√©g: ${player2Card.wisdom}</p>
    </div>
  `;

  let resultText = "";
  if (val1 > val2) {
    player1Wins++;
    resultText = "J√°t√©kos 1 nyerte a k√∂rt!";
    lastWinner = "player1";
  } else if (val2 > val1) {
    player2Wins++;
    resultText = "J√°t√©kos 2 nyerte a k√∂rt!";
    lastWinner = "player2";
  } else {
    resultText = "D√∂ntetlen!";
  }

  document.getElementById("result").textContent = resultText;
  selectedAttribute = null;

  if (player1Wins >= 5 || player2Wins >= 5) {
    document.getElementById("result").innerHTML += `<br><span class="winner">${player1Wins >= 5 ? "J√°t√©kos 1" : "J√°t√©kos 2"} gy≈ëz√∂tt a j√°t√©kban!</span>`;
    disableAll();
    document.getElementById("resetContainer").style.display = "block";
    return;
  }

  setTimeout(() => {
    refillHands();
    roundInProgress = false;
    updateUI();
  }, 1500);
}

function disableAll() {
  const buttons = document.querySelectorAll("button");
  buttons.forEach(btn => btn.disabled = true);
  document.getElementById("player1Hand").innerHTML = "";
}

function getBestCardIndex(deck, attribute, playerCardValue = null) {
  if (playerCardValue !== null) {
    let candidates = deck
      .map((card, index) => ({ value: card[attribute], index }))
      .filter(entry => entry.value >= playerCardValue);

    if (candidates.length > 0) {
      candidates.sort((a, b) => a.value - b.value);
      return candidates[0].index;
    } else {
      let weakest = deck.map((card, index) => ({ value: card[attribute], index }));
      weakest.sort((a, b) => a.value - b.value);
      return weakest[0].index;
    }
  } else {
    let bestValue = -1;
    let bestIndex = 0;
    deck.forEach((card, index) => {
      if (card[attribute] > bestValue) {
        bestValue = card[attribute];
        bestIndex = index;
      }
    });
    return bestIndex;
  }
}

startGame();
</script>

</body>
</html>
