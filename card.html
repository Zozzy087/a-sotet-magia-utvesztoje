<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <title>Kártyapárbaj - Kő-Papír-Olló stílusban</title>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Cinzel', serif;
      background-image: url('images/background.jpg.jpg');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      color: #ffffff;
      margin: 0;
      padding: 20px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 {
      font-weight: 700;
      font-size: 2.5rem;
      background-color: rgba(0, 0, 0, 0.8);
      padding: 10px 20px;
      border-radius: 5px;
      margin-bottom: 20px;
      box-shadow: 0 0 15px rgba(127, 0, 255, 0.7);
      text-align: center;
    }
    .info-box {
      background-color: rgba(0, 0, 0, 0.7);
      padding: 8px 15px;
      border-radius: 5px;
      margin: 10px auto;
      box-shadow: 0 0 10px rgba(127, 0, 255, 0.4);
      text-align: center;
    }
    #rulesBox {
      max-width: 600px;
      margin-bottom: 20px;
      padding: 15px;
    }
    #elementButtons {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 20px;
      margin: 20px auto;
    }
    .element-btn {
      background-color: rgba(0, 0, 0, 0.7);
      color: white;
      border: 2px solid #7f00ff;
      border-radius: 10px;
      padding: 15px;
      width: 120px;
      height: 120px;
      font-size: 1.1rem;
      cursor: pointer;
      box-shadow: 0 0 10px #7f00ff;
      transition: transform 0.2s, box-shadow 0.3s;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .element-btn i {
      font-size: 3rem;
      margin-bottom: 10px;
    }
    .element-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 0 15px #a94bff;
    }
    .element-btn.disabled {
      opacity: 0.5;
      pointer-events: none;
    }
    #battlefield {
      margin-top: 20px;
      display: flex;
      justify-content: center;
      gap: 40px;
      flex-wrap: wrap;
      min-height: 200px;
    }
    .battle-card {
      background-color: rgba(0, 0, 0, 0.8);
      border: 2px solid #7f00ff;
      padding: 20px;
      width: 160px;
      height: 180px;
      color: #fff;
      box-shadow: 0 0 10px rgba(127, 0, 255, 0.3);
      border-radius: 8px;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .battle-card i {
      font-size: 4rem;
      margin-bottom: 15px;
    }
    .battle-card.winner {
      border-color: #7fff7f;
      box-shadow: 0 0 20px rgba(127, 255, 127, 0.6);
    }
    .battle-text {
      color: #7fff7f;
      font-weight: bold;
      font-size: 1.2rem;
      text-shadow: 1px 1px 4px black;
    }
    #resetContainer {
      margin-top: 20px;
      display: none;
    }
    #resetBtn {
      background-color: #7f00ff;
      color: white;
      border: none;
      border-radius: 5px;
      padding: 10px 20px;
      font-size: 1.1rem;
      cursor: pointer;
      box-shadow: 0 0 10px #7f00ff;
      transition: transform 0.2s, box-shadow 0.3s;
    }
    #resetBtn:hover {
      transform: scale(1.1);
      box-shadow: 0 0 15px #a94bff;
    }
  </style>
</head>
<body>

<h1>Kártyapárbaj</h1>

<div id="rulesBox" class="info-box">
  <h3>Szabályok</h3>
  <p><i class="fas fa-fist-raised"></i> <strong>Erő</strong> legyőzi az <strong>Ügyességet</strong> - mert letiporja</p>
  <p><i class="fas fa-running"></i> <strong>Ügyesség</strong> legyőzi a <strong>Bölcsességet</strong> - mert kijátssza</p>
  <p><i class="fas fa-book"></i> <strong>Bölcsesség</strong> legyőzi az <strong>Erőt</strong> - mert túljár az eszén</p>
</div>

<div id="turnInfo" class="info-box">Várakozás a játék indítására...</div>
<div id="score" class="info-box">Állás: Játékos - 0 | Bot - 0</div>

<div id="elementButtons">
  <button class="element-btn" onclick="playRound('power')">
    <i class="fas fa-fist-raised"></i>
    <span>Erő</span>
  </button>
  <button class="element-btn" onclick="playRound('agility')">
    <i class="fas fa-running"></i>
    <span>Ügyesség</span>
  </button>
  <button class="element-btn" onclick="playRound('wisdom')">
    <i class="fas fa-book"></i>
    <span>Bölcsesség</span>
  </button>
</div>

<div id="battlefield"></div>

<div id="result" class="info-box"></div>

<div id="resetContainer">
  <button id="resetBtn" onclick="startGame()">Új játék</button>
</div>

<script>
// Játékos szokásainak követése
let playerChoices = {
  power: 0,
  agility: 0,
  wisdom: 0,
  lastChoices: []
};

// Játék állapot
let player1Wins = 0;
let player2Wins = 0;
let roundInProgress = false;

// Kő-papír-olló logika: ki kit győz le
const winLogic = {
  power: "agility",   // Erő legyőzi az Ügyességet
  agility: "wisdom",  // Ügyesség legyőzi a Bölcsességet
  wisdom: "power"     // Bölcsesség legyőzi az Erőt
};

// Ikonok a választásokhoz
const icons = {
  power: "fa-fist-raised",
  agility: "fa-running",
  wisdom: "fa-book"
};

// Magyar nyelvű megnevezések
function getHungarianName(attr) {
  return attr === "power" ? "Erő" : attr === "agility" ? "Ügyesség" : "Bölcsesség";
}

// Játék indítása
function startGame() {
  // Visszaállítjuk az adatokat
  player1Wins = 0;
  player2Wins = 0;
  roundInProgress = false;
  
  // Játékos szokásainak nullázása
  playerChoices = {
    power: 0,
    agility: 0,
    wisdom: 0,
    lastChoices: []
  };

  // UI visszaállítása
  document.getElementById("result").textContent = "";
  document.getElementById("battlefield").innerHTML = "";
  document.getElementById("score").textContent = "Állás: Játékos - 0 | Bot - 0";
  document.getElementById("turnInfo").textContent = "Válassz egy elemet!";
  document.getElementById("resetContainer").style.display = "none";
  
  // Gombok engedélyezése
  enableButtons();
}

// UI frissítése
function updateUI() {
  document.getElementById("score").textContent = `Állás: Játékos - ${player1Wins} | Bot - ${player2Wins}`;
  
  if (roundInProgress) {
    document.getElementById("turnInfo").textContent = "A kör folyamatban...";
    disableButtons();
  } else {
    // Ha új kör kezdődik, töröljük az előző eredményt
    document.getElementById("turnInfo").textContent = "Válassz egy elemet!";
    document.getElementById("battlefield").innerHTML = "";
    document.getElementById("result").textContent = "";
    enableButtons();
  }
}

// Gombok engedélyezése
function enableButtons() {
  const buttons = document.querySelectorAll(".element-btn");
  buttons.forEach(btn => {
    btn.classList.remove("disabled");
  });
}

// Gombok letiltása
function disableButtons() {
  const buttons = document.querySelectorAll(".element-btn");
  buttons.forEach(btn => {
    btn.classList.add("disabled");
  });
}

// Kör lejátszása
function playRound(playerChoice) {
  if (roundInProgress) return;
  roundInProgress = true;
  
  // Játékos választásának követése
  playerChoices[playerChoice]++;
  playerChoices.lastChoices.push(playerChoice);
  // Csak az utolsó 5 választást tartjuk meg
  if (playerChoices.lastChoices.length > 5) {
    playerChoices.lastChoices.shift();
  }
  
  // Bot választása
  const botChoice = getBotChoice();
  
  // Eredmény kiértékelése
  let result = "";
  let playerWins = false;
  
  if (playerChoice === botChoice) {
    result = "Döntetlen!";
  } else if (winLogic[playerChoice] === botChoice) {
    result = "Nyertél!";
    player1Wins++;
    playerWins = true;
  } else {
    result = "Bot nyert!";
    player2Wins++;
  }
  
  // Csatatér frissítése
  document.getElementById("battlefield").innerHTML = `
    <div class="battle-card ${playerWins ? 'winner' : ''}">
      <h3>Játékos</h3>
      <i class="fas ${icons[playerChoice]}"></i>
      <p>${getHungarianName(playerChoice)}</p>
    </div>
    <div class="battle-card ${!playerWins && playerChoice !== botChoice ? 'winner' : ''}">
      <h3>Bot</h3>
      <i class="fas ${icons[botChoice]}"></i>
      <p>${getHungarianName(botChoice)}</p>
    </div>
  `;
  
  // Eredménykijelzés
  document.getElementById("result").textContent = result;
  
  // Ellenőrizzük a játék végét
  if (player1Wins >= 5 || player2Wins >= 5) {
    const finalResult = player1Wins >= 5 ? "Gratulálok! Megnyerted a játékot!" : "A bot nyerte a játékot!";
    document.getElementById("result").innerHTML = `<span class="battle-text">${finalResult}</span>`;
    document.getElementById("resetContainer").style.display = "block";
    return;
  }
  
  // Értesítjük a UI-t a frissítéshez
  updateUI();
  
  // Késleltetés, hogy látható legyen a kör eredménye
  setTimeout(() => {
    roundInProgress = false;
    updateUI();
  }, 3000);
}

// Bot választása
function getBotChoice() {
  // Ha van elég előzmény, megpróbáljuk előrejelezni a játékos választását
  let predictedPlayerChoice = null;
  
  // Ha van elég előzmény a mintafelismeréshez
  if (playerChoices.lastChoices.length >= 3) {
    // Megvizsgáljuk, van-e ismétlődő minta
    const lastThree = playerChoices.lastChoices.slice(-3);
    
    // Ha sorban ismétli ugyanazt a tulajdonságot
    if (lastThree[0] === lastThree[1] && lastThree[1] === lastThree[2]) {
      predictedPlayerChoice = lastThree[0];
    }
    // Ha váltogatja két tulajdonság között
    else if (lastThree[0] === lastThree[2] && lastThree[0] !== lastThree[1]) {
      predictedPlayerChoice = lastThree[0];
    }
  }
  
  // 10% eséllyel véletlen választás
  if (Math.random() < 0.1) {
    const choices = ["power", "agility", "wisdom"];
    return choices[Math.floor(Math.random() * 3)];
  }
  // Ha sikerült megjósolni a játékos következő választását
  else if (predictedPlayerChoice) {
    // Válasszuk azt, ami legyőzi a megjósolt választást
    const keys = Object.keys(winLogic);
    for (const key of keys) {
      if (winLogic[key] === predictedPlayerChoice) {
        return key;
      }
    }
  }
  // 60% eséllyel ellensúlyozzuk a leggyakrabban választott tulajdonságot
  else if (Math.random() < 0.6 && playerChoices.power + playerChoices.agility + playerChoices.wisdom > 3) {
    // Játékos leggyakoribb választása
    const playerFavorite = ["power", "agility", "wisdom"].reduce((max, attr) => 
      playerChoices[attr] > playerChoices[max] ? attr : max, "power");
    
    // Válasszuk azt, ami legyőzi a leggyakoribb választást
    const keys = Object.keys(winLogic);
    for (const key of keys) {
      if (winLogic[key] === playerFavorite) {
        return key;
      }
    }
  }
  
  // 30% eséllyel véletlen választás
  const choices = ["power", "agility", "wisdom"];
  return choices[Math.floor(Math.random() * 3)];
}

// Játék indítása betöltéskor
startGame();
</script>
</body>
</html>
