<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <title>Kártyapárbaj</title>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Cinzel', serif;
      background-image: url('images/background.jpg.jpg');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      color: #ffffff;
      margin: 0;
      padding: 20px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 {
      font-weight: 700;
      font-size: 2.5rem;
      background-color: rgba(0, 0, 0, 0.8);
      padding: 10px 20px;
      border-radius: 5px;
      margin-bottom: 20px;
      box-shadow: 0 0 15px rgba(127, 0, 255, 0.7);
      text-align: center;
    }
    #turnInfo, #result, #score {
      background-color: rgba(0, 0, 0, 0.7);
      padding: 8px 15px;
      border-radius: 5px;
      margin: 10px auto;
      box-shadow: 0 0 10px rgba(127, 0, 255, 0.4);
      text-align: center;
    }
    #player1Choices {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 15px;
      margin: 20px auto;
    }
    .choice-btn {
      background-color: rgba(0, 0, 0, 0.8);
      border: 2px solid #7f00ff;
      border-radius: 8px;
      padding: 15px;
      width: 120px;
      height: 120px;
      color: #fff;
      font-family: 'Cinzel', serif;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.3s;
      box-shadow: 0 0 10px rgba(127, 0, 255, 0.3);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .choice-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 0 20px rgba(127, 0, 255, 0.6);
    }
    .choice-btn.disabled {
      opacity: 0.5;
      pointer-events: none;
    }
    .choice-btn i {
      font-size: 3rem;
      margin-bottom: 10px;
    }
    .winner {
      color: #7fff7f;
      font-weight: bold;
      text-shadow: 1px 1px 4px black;
    }
    #battlefield {
      margin-top: 20px;
      display: flex;
      justify-content: center;
      gap: 40px;
      flex-wrap: wrap;
    }
    .battle-card {
      background-color: rgba(0, 0, 0, 0.8);
      border: 2px solid #7f00ff;
      border-radius: 8px;
      padding: 15px;
      width: 150px;
      height: 180px;
      color: #fff;
      box-shadow: 0 0 10px rgba(127, 0, 255, 0.3);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
    }
    .battle-card i {
      font-size: 4rem;
      margin: 15px 0;
    }
    .battle-card.highlight {
      border-color: #7fff7f;
      box-shadow: 0 0 20px rgba(127, 255, 127, 0.6);
    }
    #resetContainer {
      margin-top: 20px;
      display: none;
    }
    button {
      background-color: #7f00ff;
      color: white;
      border: none;
      border-radius: 5px;
      padding: 10px 20px;
      font-size: 1.1rem;
      cursor: pointer;
      box-shadow: 0 0 10px #7f00ff;
      transition: transform 0.2s, box-shadow 0.3s;
    }
    button:hover {
      transform: scale(1.1);
      box-shadow: 0 0 15px #a94bff;
    }
    #rules {
      background-color: rgba(0, 0, 0, 0.7);
      padding: 15px;
      border-radius: 5px;
      margin: 15px auto;
      max-width: 600px;
      text-align: center;
    }
    #rules ul {
      display: inline-block;
      text-align: left;
    }
  </style>
</head>
<body>

<h1>Kártyapárbaj</h1>

<div id="rules">
  <h3>Szabályok:</h3>
  <ul>
    <li><i class="fas fa-fist-raised"></i> Erő legyőzi az <i class="fas fa-running"></i> Ügyességet</li>
    <li><i class="fas fa-running"></i> Ügyesség legyőzi a <i class="fas fa-brain"></i> Bölcsességet</li>
    <li><i class="fas fa-brain"></i> Bölcsesség legyőzi az <i class="fas fa-fist-raised"></i> Erőt</li>
  </ul>
</div>

<p id="turnInfo">Válassz egy kártyát!</p>

<div id="player1Choices">
  <button class="choice-btn" onclick="makeChoice('power')">
    <i class="fas fa-fist-raised"></i>
    <span>Erő</span>
  </button>
  <button class="choice-btn" onclick="makeChoice('agility')">
    <i class="fas fa-running"></i>
    <span>Ügyesség</span>
  </button>
  <button class="choice-btn" onclick="makeChoice('wisdom')">
    <i class="fas fa-brain"></i>
    <span>Bölcsesség</span>
  </button>
</div>

<div id="battlefield"></div>

<h2 id="result"></h2>
<h3 id="score"></h3>

<div id="resetContainer">
  <button onclick="startGame()">Új játék</button>
</div>

<script>
let player1Wins = 0, player2Wins = 0;
let roundInProgress = false;
let playerChoices = {
  power: 0,
  agility: 0,
  wisdom: 0,
  lastChoices: []
};

// Játék indítása
function startGame() {
  player1Wins = 0;
  player2Wins = 0;
  roundInProgress = false;
  
  // Játékos szokásainak nullázása új játék kezdetén
  playerChoices = {
    power: 0,
    agility: 0,
    wisdom: 0,
    lastChoices: []
  };

  // UI elemek visszaállítása
  document.getElementById("result").textContent = "";
  document.getElementById("battlefield").innerHTML = "";
  document.getElementById("score").textContent = "Állás: Játékos - 0 | Bot - 0";
  document.getElementById("turnInfo").textContent = "Válassz egy kártyát!";

  // Reset gomb elrejtése
  document.getElementById("resetContainer").style.display = "none";
  
  // Gombok engedélyezése
  enableButtons();
}

// Gomb ikonok és nevek megfeleltetése
function getChoiceIcon(choice) {
  switch(choice) {
    case 'power': return '<i class="fas fa-fist-raised"></i>';
    case 'agility': return '<i class="fas fa-running"></i>';
    case 'wisdom': return '<i class="fas fa-brain"></i>';
    default: return '';
  }
}

function getChoiceName(choice) {
  switch(choice) {
    case 'power': return 'Erő';
    case 'agility': return 'Ügyesség';
    case 'wisdom': return 'Bölcsesség';
    default: return '';
  }
}

// Gombok engedélyezése/letiltása
function enableButtons() {
  const buttons = document.querySelectorAll(".choice-btn");
  buttons.forEach(btn => {
    btn.classList.remove("disabled");
  });
}

function disableButtons() {
  const buttons = document.querySelectorAll(".choice-btn");
  buttons.forEach(btn => {
    btn.classList.add("disabled");
  });
}

// Játékos választása
function makeChoice(choice) {
  if (roundInProgress) return;
  roundInProgress = true;
  
  // Rögzítjük a játékos választását a szokások követéséhez
  playerChoices[choice]++;
  playerChoices.lastChoices.push(choice);
  // Csak az utolsó 5 választást tartjuk meg
  if (playerChoices.lastChoices.length > 5) {
    playerChoices.lastChoices.shift();
  }
  
  // Letiltjuk a gombokat amíg tart a kör
  disableButtons();
  
  // Megjelenítjük a játékos választását
  document.getElementById("battlefield").innerHTML = `
    <div class="battle-card">
      <h3>Játékos</h3>
      ${getChoiceIcon(choice)}
      <p>${getChoiceName(choice)}</p>
    </div>
  `;
  
  // Bot választ kis késleltetéssel
  setTimeout(() => {
    const botChoice = getBotChoice();
    
    // Megjelenítjük a bot választását
    document.getElementById("battlefield").innerHTML += `
      <div class="battle-card">
        <h3>Bot</h3>
        ${getChoiceIcon(botChoice)}
        <p>${getChoiceName(botChoice)}</p>
      </div>
    `;
    
    // Kiértékeljük az eredményt
    const result = evaluateRound(choice, botChoice);
    
    // Megjelenítjük az eredményt
    displayResult(result, choice, botChoice);
    
    // Kör vége után újra engedélyezzük a választást
    setTimeout(() => {
      roundInProgress = false;
      
      // Ha még nincs vége a játéknak
      if (player1Wins < 5 && player2Wins < 5) {
        enableButtons();
      } else {
        // Játék vége esetén megjelenítjük az új játék gombot
        document.getElementById("resetContainer").style.display = "block";
      }
    }, 2000);
  }, 1000);
}

// Bot választása
function getBotChoice() {
  // Bot intelligensen választ a játékos szokásai alapján
  
  // Analizáljuk a játékos választási mintáit
  let predictedPlayerChoice = null;
  
  // Ha van elég előzmény, megpróbáljuk előrejelezni a következő választását
  if (playerChoices.lastChoices.length >= 3) {
    // Megvizsgáljuk, van-e ismétlődő minta
    const lastThree = playerChoices.lastChoices.slice(-3);
    
    // Ha sorban ismétli ugyanazt a tulajdonságot
    if (lastThree[0] === lastThree[1] && lastThree[1] === lastThree[2]) {
      predictedPlayerChoice = lastThree[0];
    }
    
    // Ha váltogatja két tulajdonság között
    else if (lastThree[0] === lastThree[2] && lastThree[0] !== lastThree[1]) {
      predictedPlayerChoice = lastThree[0];
    }
  }
  
  // 20% eséllyel véletlenszerű választás (hogy ne legyen túl kiszámítható)
  if (Math.random() < 0.2) {
    const choices = ["power", "agility", "wisdom"];
    return choices[Math.floor(Math.random() * 3)];
  }
  
  // Ha sikerült megjósolni a játékos következő választását, olyan kártyát választunk, ami legyőzi
  else if (predictedPlayerChoice) {
    // Kiválasztjuk a nyerő kártyát
    switch(predictedPlayerChoice) {
      case 'power': return 'wisdom'; // Bölcsesség legyőzi az Erőt
      case 'agility': return 'power'; // Erő legyőzi az Ügyességet
      case 'wisdom': return 'agility'; // Ügyesség legyőzi a Bölcsességet
    }
  }
  
  // 60% eséllyel a leggyakrabban választott tulajdonságot ellenőrizzük
  else if (Math.random() < 0.6 && playerChoices.power + playerChoices.agility + playerChoices.wisdom > 2) {
    // Játékos leggyakoribb választása
    const playerFavorite = ["power", "agility", "wisdom"].reduce((max, attr) => 
      playerChoices[attr] > playerChoices[max] ? attr : max, "power");
    
    // Kiválasztjuk a nyerő kártyát
    switch(playerFavorite) {
      case 'power': return 'wisdom'; // Bölcsesség legyőzi az Erőt
      case 'agility': return 'power'; // Erő legyőzi az Ügyességet
      case 'wisdom': return 'agility'; // Ügyesség legyőzi a Bölcsességet
    }
  }
  
  // Egyébként véletlenszerű választás
  const choices = ["power", "agility", "wisdom"];
  return choices[Math.floor(Math.random() * 3)];
}

// Kör kiértékelése
function evaluateRound(playerChoice, botChoice) {
  // Döntetlen
  if (playerChoice === botChoice) {
    return "draw";
  }
  
  // Nyert a játékos
  if ((playerChoice === "power" && botChoice === "agility") ||
      (playerChoice === "agility" && botChoice === "wisdom") ||
      (playerChoice === "wisdom" && botChoice === "power")) {
    player1Wins++;
    return "player";
  }
  
  // Nyert a bot
  player2Wins++;
  return "bot";
}

// Eredmény megjelenítése
function displayResult(result, playerChoice, botChoice) {
  // Eredmény szöveg
  let resultText = "";
  if (result === "draw") {
    resultText = "Döntetlen!";
  } else if (result === "player") {
    resultText = "Játékos nyerte a kört!";
  } else {
    resultText = "Bot nyerte a kört!";
  }
  
  // Jelöljük a győztes kártyát
  const cards = document.querySelectorAll(".battle-card");
  if (result === "player") {
    cards[0].classList.add("highlight");
  } else if (result === "bot") {
    cards[1].classList.add("highlight");
  }
  
  document.getElementById("result").textContent = resultText;
  document.getElementById("score").textContent = `Állás: Játékos - ${player1Wins} | Bot - ${player2Wins}`;
  
  // Ellenőrizzük, hogy vége van-e a játéknak
  if (player1Wins >= 5 || player2Wins >= 5) {
    document.getElementById("result").innerHTML += `<br><span class="winner">${player1Wins >= 5 ? "Játékos" : "Bot"} győzött a játékban!</span>`;
    disableButtons();
    document.getElementById("resetContainer").style.display = "block";
  }
}

// Játék indítása
startGame();
</script>
</body>
</html>
